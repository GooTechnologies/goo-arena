{"7dd860ba25584de1af34fe242edcdbb0.entity":{"name":"Scripts","license":"CC0","created":"2014-12-09T10:18:22.059879+00:00","deleted":false,"tags":{},"dataModelVersion":2,"modified":"2014-12-09T10:18:22.059901+00:00","static":false,"components":{"transform":{"rotation":[0,0,0],"scale":[1,1,1],"translation":[0,0,0],"children":{}},"script":{"scripts":{"32f02d3228164dbbb499997c042ba03b.scriptinstance":{"scriptRef":"c97bcb54014b4f76b48fc50e6adf33ae.script","options":{"enabled":true},"id":"32f02d3228164dbbb499997c042ba03b.scriptinstance","sortValue":11,"name":"Custom script"},"67ddf21c1cb148da8c779a2e9feb37e6.scriptinstance":{"scriptRef":"c000042ac5a94fd695acce743602bbf7.script","options":{"enabled":true,"boomSoundEntity":{"entityRef":"3d331d7b8a7546e29c8ad2042f83e3ab.entity"},"shotSoundEntity":{"entityRef":"03749b918c6a4d4a9248c9b4e8c852a0.entity"}},"id":"67ddf21c1cb148da8c779a2e9feb37e6.scriptinstance","sortValue":17,"name":"Custom script"},"a1dd1dcbb3174b06896fd7f7761b70ef.scriptinstance":{"scriptRef":"af91f807ff3b43f4b51d0099d1dc3190.script","options":{"enabled":true},"id":"a1dd1dcbb3174b06896fd7f7761b70ef.scriptinstance","sortValue":15,"name":"Custom script"},"7e11bb14a75841b8bbd1562e032c9c22.scriptinstance":{"scriptRef":"c6ff4413cc27419ba272d3ce5c1fc07f.script","options":{"lifeTime":1,"numEntities":5,"numImpacts":10,"enabled":true},"id":"7e11bb14a75841b8bbd1562e032c9c22.scriptinstance","sortValue":7,"name":"Custom script"},"0b1c36aadf46471587134c383d23c239.scriptinstance":{"scriptRef":"1ef1364e04d94c5aa159d81b60cc1c2c.script","options":{"enabled":true},"id":"0b1c36aadf46471587134c383d23c239.scriptinstance","sortValue":2,"name":"Custom script"},"ddfe376b8b5e4a94ab396a8d8c0094d0.scriptinstance":{"scriptRef":"bdc6faf75115419286209fa30dd17e0c.script","options":{"enabled":true},"id":"ddfe376b8b5e4a94ab396a8d8c0094d0.scriptinstance","sortValue":16,"name":"Custom script"},"812225d88b9649968966ed5b317c7cba.scriptinstance":{"scriptRef":"7c641ba033da44dcb00840da16155ff0.script","options":{"enabled":true},"id":"812225d88b9649968966ed5b317c7cba.scriptinstance","sortValue":10,"name":"Custom script"},"98b9433555244d15819e2dc6b52b558f.scriptinstance":{"scriptRef":"a443f2ef9ca74b68bcd7db81ab1e118f.script","options":{"enabled":true},"id":"98b9433555244d15819e2dc6b52b558f.scriptinstance","sortValue":8,"name":"Custom script"},"73eecb0f0b6b408a928fcf8777c93e81.scriptinstance":{"scriptRef":"d2825b5b9ed84d47917e9f010fb125f5.script","options":{"enabled":true},"id":"73eecb0f0b6b408a928fcf8777c93e81.scriptinstance","sortValue":0,"name":"Custom script"},"bfd3b2ed9e2044cb92feefc6e38eebd3.scriptinstance":{"scriptRef":"c285b989b9d84501a8c7493adfae9fc5.script","options":{"enabled":true},"id":"bfd3b2ed9e2044cb92feefc6e38eebd3.scriptinstance","sortValue":9,"name":"Custom script"},"7eedd3c1f24c4e61801bc52025b0e6fa.scriptinstance":{"scriptRef":"facdb3e7d90d4fd486739c38c7ac6ac5.script","options":{"masterEntity":{"entityRef":"3be4ae77975a4df9bb1b134eef605dda.entity"},"enabled":true},"id":"7eedd3c1f24c4e61801bc52025b0e6fa.scriptinstance","sortValue":13,"name":"Custom script"},"f30716430d2e4c159f75b993313a99b2.scriptinstance":{"scriptRef":"b1fc00b31bf1439ab2d1bfe36fda1757.script","options":{"enabled":true},"id":"f30716430d2e4c159f75b993313a99b2.scriptinstance","sortValue":14,"name":"Custom script"},"f0a296c0ce3d4416ab3ef132d7e24a56.scriptinstance":{"scriptRef":"5069d7230bf948f2bce8aebc0af137cd.script","options":{"enabled":true},"id":"f0a296c0ce3d4416ab3ef132d7e24a56.scriptinstance","sortValue":12,"name":"Custom script"},"e808479fcca740629d7eb9c500620d2d.scriptinstance":{"scriptRef":"a3554adfce12433ca673b875aeca56a8.script","options":{"host":"https://goo-shooter.herokuapp.com","enabled":true},"id":"e808479fcca740629d7eb9c500620d2d.scriptinstance","sortValue":3,"name":"Custom script"},"5deecb25a7094ca2a7507e68cb2a3259.scriptinstance":{"scriptRef":"15fbb7eae6814695a34bf8fd10415400.script","options":{"enabled":true},"id":"5deecb25a7094ca2a7507e68cb2a3259.scriptinstance","sortValue":5,"name":"Custom script"}}}},"hidden":false,"id":"7dd860ba25584de1af34fe242edcdbb0.entity"},"d673646b2a114245b02e9062c9d95c53.sound":{"name":"pain25_1","license":"CC0","created":"2014-12-09T10:18:26.534866+00:00","deleted":false,"audioRefs":{"wav":"0341234c6604565e332c2a864112457382432ee4.wav"},"dataModelVersion":2,"modified":"2014-12-09T10:18:26.534886+00:00","volume":1,"id":"d673646b2a114245b02e9062c9d95c53.sound","loop":false},"c3ce6b61777c4b838211a26c4551306d.texture":{"wrapS":"Repeat","minFilter":"BilinearNoMipMaps","imageRef":"3b6f27e5fc7eaa528c687a139569b0091a8addc8.jpg","license":"CC0","flipY":false,"deleted":false,"name":"texture_46","magFilter":"Bilinear","created":"2014-12-09T10:18:22.399589+00:00","dataModelVersion":2,"modified":"2014-12-09T10:18:22.399614+00:00","repeat":[0,0],"anisotropy":1,"offset":[0,0],"id":"c3ce6b61777c4b838211a26c4551306d.texture","generateMipmaps":true,"originalLicense":"CC0","wrapT":"Repeat"},"d2825b5b9ed84d47917e9f010fb125f5.script":{"body":"/*\n\nTakes care of keyboard input and mouse clicks\n\n*/\n\n\nvar g;\nvar setup = function(args, ctx, goo) {\n\tg = goo;\n\t\n\tctx.keyCodes = {\n\t\t'87': 'fwd',\n\t\t'83': 'bwd',\n\t\t'65': 'left',\n\t\t'68': 'right'\n\t};\n\t\n\tctx.worldData.keyState = {\n\t\tfwd: false,\n\t\tbwd: false,\n\t\tleft: false,\n\t\tright: false\n\t};\n\t\n\tctx.worldData.inputSeq = 0;\n\tctx.worldData.inputQueue = [];\n\t\n\tctx.windowListeners = {\n\t\tmousedown: function(evt) {\n\t\t\tif (evt.button === 0) {\n\t\t\t\tleftClick(ctx);\n\t\t\t}\n\t\t},\n\t\tkeydown: function(evt) {\n\t\t\tif (ctx.keyCodes[evt.keyCode] !== undefined) {\n\t\t\t\tkeyDown(ctx, evt.keyCode);\n\t\t\t}\n\t\t},\n\t\tkeyup: function(evt) {\n\t\t\tif (ctx.keyCodes[evt.keyCode] !== undefined) {\n\t\t\t\tkeyUp(ctx, evt.keyCode);\n\t\t\t}\t\n\t\t}\n\t};\n\t\n\tObject.keys(ctx.windowListeners).forEach(function(v) {\n\t\twindow.addEventListener(v, ctx.windowListeners[v]);\n\t});\n\n};\n\nvar leftClick = function(ctx) {\n\tif (ctx.worldData.id === undefined || ctx.worldData.alive !== true) return;\n\tg.SystemBus.emit('fire');\n};\n\nvar keyDown = function(ctx, keyCode) {\n\tif (ctx.worldData.id === undefined || ctx.worldData.alive !== true) return;\n\tctx.worldData.keyState[ctx.keyCodes[keyCode]] = true;\n\tg.SystemBus.emit('key_state_changed');\n};\n\nvar keyUp = function(ctx, keyCode) {\n\tif (ctx.worldData.id === undefined || ctx.worldData.alive !== true) return;\n\tctx.worldData.keyState[ctx.keyCodes[keyCode]] = false;\n\tg.SystemBus.emit('key_state_changed');\n};\n\nvar cleanup = function(args, ctx, goo) {\n\tObject.keys(ctx.windowListeners).forEach(function(v) {\n\t\twindow.removeEventListener(v, ctx.windowListeners[v]);\n\t});\n};\n","name":"Keyboard and Mouse Clicks","license":"CC0","created":"2014-12-09T10:18:23.855768+00:00","deleted":false,"modified":"2014-12-09T10:18:23.855790+00:00","dataModelVersion":2,"dependencies":{},"id":"d2825b5b9ed84d47917e9f010fb125f5.script"},"c17f0a9d5a6740358abf80f3c062b673.entity":{"name":"Z- Wall","license":"CC0","tags":{},"deleted":false,"created":"2014-12-09T10:18:23.379447+00:00","dataModelVersion":2,"modified":"2014-12-09T10:18:23.379474+00:00","static":false,"components":{"transform":{"translation":[0,0,-50],"scale":[100,10,1],"rotation":[0,0,0]},"meshRenderer":{"receiveShadows":true,"materials":{"8021ee4cb6f74e7c8a023d7d8ec9b231.material":{"materialRef":"8021ee4cb6f74e7c8a023d7d8ec9b231.material","sortValue":0}},"reflectable":true,"cullMode":"Dynamic","castShadows":true},"meshData":{"shape":"Quad"}},"hidden":false,"id":"c17f0a9d5a6740358abf80f3c062b673.entity"},"4b89354ffce14b939d098ff721788b67.entity":{"name":"Info Panel","license":"CC0","tags":{},"deleted":false,"created":"2014-12-09T10:18:23.523256+00:00","modified":"2014-12-09T10:18:23.523276+00:00","dataModelVersion":2,"static":false,"components":{"html":{"imageRefs":{},"useTransformComponent":false,"innerHtml":"<style>\n\t#info {\n\t\twidth: 150px;\n\t\tbackground-color: white;\n\t\tfont-size: 12px;\n\t\tfont-family: 'Trebuchet MS';\n\t\tpadding: 5px;\n\t}\n</style>\n\n<div id='info'>\n\tName: <span id='info-name'>?</span><br />\n\tID: <span id='info-id'>?</span><br />\n\tLatency: <span id='info-latency'>?</span><br />\n\tHealth: <span id='info-health'>?</span><br />\n\tKills: <span id='info-kills'>?</span><br />\n\tDeaths: <span id='info-deaths'>?</span>\n</div>"},"transform":{"translation":[0,0,0],"scale":[1,1,1],"rotation":[0,0,0]}},"hidden":true,"id":"4b89354ffce14b939d098ff721788b67.entity"},"1ef1364e04d94c5aa159d81b60cc1c2c.script":{"body":"/*\n\nSets rotation using the mouse position. Also handles the mouse lock\nmechanisms.\n\nNote that the server (currently) does not care about rotation.\n\n*/\n\n\nvar setup = function(args, ctx, goo) {\n\tctx.worldData.mouse = [0, 0];\n\t\n\tctx.lockMouse = function() {\n\t\tdocument.documentElement.requestPointerLock();\n\t\tdocument.addEventListener('pointerlockerror', function(error) {\n\t\t\tconsole.error('Pointer lock error', error);\n\t\t}, false);\t\n\t};\n\tgoo.SystemBus.addListener('lock_mouse', ctx.lockMouse);\n\n\tctx.windowListeners = {\n\t\tkeyup: function(evt) {\n\t\t\t// Press F to re-lock mouse\n\t\t\tif (evt.keyCode === 70) {\n\t\t\t\tgoo.SystemBus.emit('lock_mouse');\n\t\t\t}\t\n\t\t},\n\t\tmousemove: function(evt) {\n\t\t\tvar moveX = evt.movementX || evt.mozMovementX || evt.webkitMovementX;\n\t\t\tvar moveY = evt.movementY || evt.mozMovementY || evt.webkitMovementY;\n\t\t\tif(moveX !== undefined && moveY !== undefined){\n\t\t\t\tmouseMove(ctx, moveX, moveY);\n\t\t\t}\n\t\t}\n\t};\n\tObject.keys(ctx.windowListeners).forEach(function(v) {\n\t\tdocument.addEventListener(v, ctx.windowListeners[v]);\n\t});\n\t\n};\n\nvar cleanup = function(args, ctx, goo) {\n\tif (document.pointerLockElement === document.documentElement) {\n\t\tdocument.exitPointerLock();\n\t}\n\tObject.keys(ctx.windowListeners).forEach(function(v) {\n\t\tdocument.removeEventListener(v, ctx.windowListeners[v]);\n\t});\n\tgoo.SystemBus.removeListener('lock_mouse', ctx.lockMouse);\n};\n\nvar mouseMove = function(ctx, x, y) {\n\tctx.worldData.mouse[0] += x;\n\tctx.worldData.mouse[1] += y;\n};\n","name":"Mouse","license":"CC0","created":"2014-12-09T10:18:26.446624+00:00","deleted":false,"dataModelVersion":2,"modified":"2014-12-09T10:18:26.446645+00:00","dependencies":{},"id":"1ef1364e04d94c5aa159d81b60cc1c2c.script"},"16c98b042c0d4f39b36ab4b7831fb308.entity":{"name":"Floor","license":"CC0","tags":{},"deleted":false,"created":"2014-12-09T10:18:23.127481+00:00","dataModelVersion":2,"modified":"2014-12-09T10:18:23.127506+00:00","static":false,"components":{"transform":{"translation":[0,-1,0],"scale":[100,100,100],"rotation":[-90,0,0]},"meshRenderer":{"receiveShadows":true,"materials":{"bf84dfe1c17a4d949157649a3b0bb55e.material":{"materialRef":"bf84dfe1c17a4d949157649a3b0bb55e.material","sortValue":0}},"reflectable":true,"cullMode":"Dynamic","castShadows":true},"meshData":{"shape":"Quad"}},"hidden":false,"id":"16c98b042c0d4f39b36ab4b7831fb308.entity"},"50516938902943138a6a4343635b147a.entity":{"name":"Directional","license":"CC0","tags":{},"deleted":false,"created":"2014-12-09T10:18:21.364525+00:00","modified":"2014-12-09T10:18:21.364545+00:00","dataModelVersion":2,"static":false,"components":{"light":{"direction":[0,0,0],"shadowCaster":false,"color":[1,1,1,1],"intensity":0.35,"range":60,"specularIntensity":0.1,"penumbra":5,"angle":30,"type":"DirectionalLight","shadowSettings":{"fov":55,"darkness":1,"far":60,"near":1,"resolution":[256,256],"shadowType":"Basic","size":100}},"transform":{"rotation":[-24.90991676154265,49.927764172349846,-35.878816370442316],"scale":[1,1,1],"translation":[16,20.5,23.3]}},"hidden":false,"id":"50516938902943138a6a4343635b147a.entity"},"8021ee4cb6f74e7c8a023d7d8ec9b231.material":{"texturesMapping":{"DIFFUSE_MAP":{"enabled":true,"textureRef":"8ff1e27efc814544ae54fcdf836a3634.texture"}},"flat":false,"cullState":{"frontFace":"CCW","enabled":true,"cullFace":"Back"},"uniforms":{"opacity":{"enabled":false,"value":1},"refractivity":{"enabled":false,"value":0},"materialAmbient":{"enabled":true,"value":[0.1,0.1,0.1,1]},"materialSpecular":{"enabled":true,"value":[0.6,0.6,0.6,1]},"fresnel":{"enabled":true,"value":0},"vertexColorAmount":{"enabled":true,"value":1},"materialSpecularPower":{"enabled":true,"value":64},"materialDiffuse":{"enabled":true,"value":[0,0,0,1]},"reflectivity":{"enabled":true,"value":0},"materialEmissive":{"enabled":true,"value":[0.19599999999999998,0.4083333333333333,0,1]},"discardThreshold":{"enabled":true,"value":0.1},"normalMultiplier":{"enabled":true,"value":1},"etaRatio":{"enabled":true,"value":-0.5},"reflectionType":0,"wrapSettings":{"enabled":true,"value":[0,0]}},"name":"Material 5","license":"CC0","created":"2014-12-09T10:18:26.248962+00:00","deleted":false,"wireframe":false,"dataModelVersion":2,"blendState":{"blendEquation":"AddEquation","blendSrc":"SrcAlphaFactor","blendDst":"OneMinusSrcAlphaFactor","blending":"NoBlending"},"modified":"2014-12-09T10:18:26.248985+00:00","dualTransparency":false,"depthState":{"write":true,"enabled":true},"shaderRef":"GOO_ENGINE_SHADERS/uber","id":"8021ee4cb6f74e7c8a023d7d8ec9b231.material","renderQueue":-1},"5d3164c6dd084c64937d099f313a97b6.material":{"texturesMapping":{},"flat":false,"cullState":{"frontFace":"CCW","enabled":true,"cullFace":"Back"},"uniforms":{"opacity":{"enabled":true,"value":0},"refractivity":{"enabled":false,"value":0},"materialAmbient":{"enabled":true,"value":[0,0,0,1]},"materialSpecular":{"enabled":true,"value":[0,0,0,1]},"fresnel":{"enabled":true,"value":0},"vertexColorAmount":{"enabled":true,"value":1},"materialSpecularPower":{"enabled":true,"value":64},"materialDiffuse":{"enabled":true,"value":[0,0,0,1]},"reflectivity":{"enabled":true,"value":0},"materialEmissive":{"enabled":true,"value":[1,0,0,1]},"discardThreshold":{"enabled":true,"value":0.1},"normalMultiplier":{"enabled":true,"value":1},"etaRatio":{"enabled":true,"value":-0.5},"reflectionType":0,"wrapSettings":{"enabled":true,"value":[0,0]}},"name":"Material 4","license":"CC0","created":"2014-12-09T10:18:23.807494+00:00","deleted":false,"wireframe":false,"dataModelVersion":2,"blendState":{"blendEquation":"AddEquation","blendSrc":"SrcAlphaFactor","blendDst":"OneMinusSrcAlphaFactor","blending":"TransparencyBlending"},"modified":"2014-12-09T10:18:23.807526+00:00","dualTransparency":false,"depthState":{"write":true,"enabled":true},"shaderRef":"GOO_ENGINE_SHADERS/uber","id":"5d3164c6dd084c64937d099f313a97b6.material","renderQueue":-1},"bdc6faf75115419286209fa30dd17e0c.script":{"body":"// Add/remove bots with up/down keys\r\n// TODO unify keys and make sure nothing collides, etc\r\n\r\nvar setup = function(args, ctx, goo) {\r\nctx.windowListeners = {\r\n\t\tkeyup: function(evt) {\r\n\t\t\tif (evt.keyCode === 38) {\r\n\t\t\t\tctx.worldData.pushMessage('c_add_bot');\r\n\t\t\t} else if (evt.keyCode === 40) {\r\n\t\t\t\tctx.worldData.pushMessage('c_remove_bot');\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tObject.keys(ctx.windowListeners).forEach(function(v) {\r\n\t\twindow.addEventListener(v, ctx.windowListeners[v]);\r\n\t});\r\n};\r\n\r\n\r\nvar cleanup = function(args, ctx, goo) {\r\n\tObject.keys(ctx.windowListeners).forEach(function(v) {\r\n\t\twindow.removeEventListener(v, ctx.windowListeners[v]);\r\n\t});\r\n};\r\n","name":"Bots","license":"CC0","created":"2014-12-09T10:18:24.582817+00:00","deleted":false,"modified":"2014-12-09T10:18:24.582843+00:00","dataModelVersion":2,"id":"bdc6faf75115419286209fa30dd17e0c.script"},"6475233573624485941e03c345b05f9a.sound":{"name":"opp_gun","license":"CC0","created":"2014-12-09T10:18:24.536192+00:00","deleted":false,"audioRefs":{"mp3":"b88dc2d382ad42e5bb11822d0e366eaa1a5a364f.mp3"},"dataModelVersion":2,"modified":"2014-12-09T10:18:24.536217+00:00","volume":0.5,"id":"6475233573624485941e03c345b05f9a.sound","loop":false},"8ff1e27efc814544ae54fcdf836a3634.texture":{"wrapS":"Repeat","minFilter":"Trilinear","name":"tile.jpg 5","license":"CC0","flipY":true,"deleted":false,"magFilter":"Bilinear","created":"2014-12-09T10:18:25.435107+00:00","dataModelVersion":2,"modified":"2014-12-09T10:18:25.435129+00:00","repeat":[100,12],"imageRef":"5bf486f06882cbc53ec3819fb900b3a0c17cd0e4.jpg","lodBias":0,"offset":[0,0],"id":"8ff1e27efc814544ae54fcdf836a3634.texture","generateMipmaps":true,"anisotropy":1,"wrapT":"Repeat"},"c7f6aa5a444b41acae22b7f8ee649c08.texture":{"wrapS":"Repeat","minFilter":"BilinearNoMipMaps","imageRef":"63a6f697e62e887ca54aab6d9b58fa319f7ba611.jpg","license":"CC0","flipY":false,"deleted":false,"name":"texture_48","magFilter":"Bilinear","created":"2014-12-09T10:18:22.800627+00:00","dataModelVersion":2,"modified":"2014-12-09T10:18:22.800654+00:00","repeat":[0,0],"anisotropy":1,"offset":[0,0],"id":"c7f6aa5a444b41acae22b7f8ee649c08.texture","generateMipmaps":true,"originalLicense":"CC0","wrapT":"Repeat"},"b1fc00b31bf1439ab2d1bfe36fda1757.script":{"body":"/*\n\n\tShow a score leaderboard. On keypress, but also provide a listener\n\tfor other scripts to call (for example when the player dies).\n\t\n*/\n\n\nvar g;\nvar setup = function(args, ctx, goo) {\n\tg = goo;\n\t\n\tctx.scoreOuter = document.getElementById('scores-wrapper');\n\tctx.scoreScreen = document.getElementById('scores-table');\n\t\n\tctx.keyListeners = {\n\t\tkeydown: function(evt) {\n\t\t\tif (evt.keyCode == 81) {\n\t\t\t\tg.SystemBus.emit('show_scores');\n\t\t\t}\n\t\t},\n\t\tkeyup: function(evt) {\n\t\t\tif (evt.keyCode == 81) {\n\t\t\t\tg.SystemBus.emit('hide_scores');\n\t\t\t}\n\t\t}\n\t};\n\t\n\tObject.keys(ctx.keyListeners).forEach(function(v) {\n\t\twindow.addEventListener(v, ctx.keyListeners[v]);\n\t});\n\t\n\tctx.showScores = function() {\n\t\tshowScores(ctx);\n\t};\n\tg.SystemBus.addListener('show_scores', ctx.showScores);\n\t\n\tctx.hideScores = function() {\n\t\thideScores(ctx);\n\t};\n\tg.SystemBus.addListener('hide_scores', ctx.hideScores);\n\t\n\n};\n\nvar cleanup = function(args, ctx, goo) {\n\tg.SystemBus.removeListener('show_scores', ctx.showScores);\n\tg.SystemBus.removeListener('hide_scores', ctx.hideScores);\n\tObject.keys(ctx.keyListeners).forEach(function(v) {\n\t\twindow.removeEventListener(v, ctx.keyListeners[v]);\n\t});\n};\n\nvar hideScores = function(ctx) {\n\tctx.scoreScreen.style.display = 'none';\n};\n\nvar showScores = function(ctx) {\n\tvar playerStats = [];\n\tObject.keys(ctx.worldData.playersNew).forEach(function(v) {\n\t\tplayerStats.push({\n\t\t\tname: ctx.worldData.playersNew[v].name,\n\t\t\tkills: ctx.worldData.playersNew[v].kills,\n\t\t\tdeaths: ctx.worldData.playersNew[v].deaths\n\t\t});\n\t});\n\tplayerStats.sort(function(a,b) {\n\t\treturn (a.kills - b.kills);\n\t});\n\t\n\tclearScores(ctx);\n\tbuildScores(ctx, playerStats);\n\tctx.scoreOuter.style.width = ctx.domElement.width/window.devicePixelRatio + 'px';\n\tctx.scoreScreen.style.display = 'inline-table';\n};\n\nvar buildScores = function(ctx, playerStats) {\n\tplayerStats.forEach(function(v, i) {\n\t\tvar r = ctx.scoreScreen.insertRow(1);\n\t\tr.className = (i % 2 === 0) ? 'even' : 'odd';\n\t\tvar cn = r.insertCell(0);\n\t\tvar ck = r.insertCell(1);\n\t\tvar cd = r.insertCell(2);\n\t\tcn.innerHTML = v.name;\n\t\tck.innerHTML = v.kills;\n\t\tcd.innerHTML = v.deaths;\n\t});\n};\n\nvar clearScores = function(ctx) {\n\tvar i = ctx.scoreScreen.getElementsByTagName('tr').length-1;\n\twhile (i--) {\n\t\tctx.scoreScreen.deleteRow(1);\n\t}\n};","name":"Score Screen","license":"CC0","created":"2014-12-09T10:18:25.242791+00:00","deleted":false,"modified":"2014-12-09T10:18:25.242820+00:00","dataModelVersion":2,"id":"b1fc00b31bf1439ab2d1bfe36fda1757.script"},"0d1ab50be913487ab8471e6404632e22.entity":{"name":"X- Wall","license":"CC0","tags":{},"deleted":false,"created":"2014-12-09T10:18:25.384567+00:00","dataModelVersion":2,"modified":"2014-12-09T10:18:25.384587+00:00","static":false,"components":{"transform":{"translation":[-50,0,0],"scale":[100,10,1],"rotation":[0,90,0]},"meshRenderer":{"receiveShadows":true,"materials":{"8021ee4cb6f74e7c8a023d7d8ec9b231.material":{"materialRef":"8021ee4cb6f74e7c8a023d7d8ec9b231.material","sortValue":0}},"reflectable":true,"cullMode":"Dynamic","castShadows":true},"meshData":{"shape":"Quad"}},"hidden":false,"id":"0d1ab50be913487ab8471e6404632e22.entity"},"4fcbdd6b85f6402bb0dc79ed7cd31408.texture":{"wrapS":"Repeat","minFilter":"BilinearNoMipMaps","imageRef":"b22e04e2c43699c2c427ceaa3ff99d9886c2335b.jpg","license":"CC0","flipY":false,"deleted":false,"name":"texture_49","magFilter":"Bilinear","created":"2014-12-09T10:18:23.616231+00:00","dataModelVersion":2,"modified":"2014-12-09T10:18:23.616256+00:00","repeat":[0,0],"anisotropy":1,"offset":[0,0],"id":"4fcbdd6b85f6402bb0dc79ed7cd31408.texture","generateMipmaps":true,"originalLicense":"CC0","wrapT":"Repeat"},"3d331d7b8a7546e29c8ad2042f83e3ab.entity":{"name":"Boom Sound 3D","license":"CC0","tags":{},"deleted":false,"created":"2014-12-09T10:18:24.387456+00:00","dataModelVersion":2,"modified":"2014-12-09T10:18:24.387482+00:00","static":false,"components":{"sound":{"volume":1,"sounds":{"39fef29a8296450ebb61ce4c5bd80d34.sound":{"soundRef":"39fef29a8296450ebb61ce4c5bd80d34.sound","sortValue":0}}},"transform":{"translation":[0,0,0],"scale":[1,1,1],"rotation":[0,0,0]}},"hidden":false,"id":"3d331d7b8a7546e29c8ad2042f83e3ab.entity"},"0c78d2a43d934df2a44265674f2edfed.entity":{"name":"Player Camera","license":"CC0","tags":{},"deleted":false,"created":"2014-12-09T10:18:23.477228+00:00","modified":"2014-12-09T10:18:23.477250+00:00","dataModelVersion":2,"static":false,"components":{"camera":{"fov":45,"lockedRatio":false,"far":1000,"projectionMode":"Perspective","near":0.1,"aspect":1,"size":100},"transform":{"translation":[0,0.5,0],"scale":[1,1,1],"rotation":[0,0,0],"children":{"c12c0e3deb514efa90aec61502fffa05.entity":{"entityRef":"c12c0e3deb514efa90aec61502fffa05.entity","sortValue":1},"5b2f9e08c6ab4fde8007483f8d35800a.entity":{"entityRef":"5b2f9e08c6ab4fde8007483f8d35800a.entity","sortValue":0},"db0ac50aa42e4daaa7e6def88da5d421.entity":{"entityRef":"db0ac50aa42e4daaa7e6def88da5d421.entity","sortValue":2}}},"stateMachine":{"machines":{"9ad11ee10edc40568562d5b68e540cd8.machine":{"machineRef":"9ad11ee10edc40568562d5b68e540cd8.machine","sortValue":0}}},"script":{"scripts":{}}},"hidden":false,"id":"0c78d2a43d934df2a44265674f2edfed.entity"},"15fbb7eae6814695a34bf8fd10415400.script":{"body":"/*\n\nTakes care of all opponent rendering.\nHere's where the entity interpolation happens.\n\nThe last two known opponent states are saved, and the amout of time\nbetween server updates is estimated. This value is uses to interpolate\nbetween the two positions, rendering a somewhat smooth movement.\n\n*/\n\n\nvar g;\n\nvar setup = function(args, ctx, goo) {\n\tg = goo;\n\tctx.oppEntities = {};\n\t\n\tctx.meshData = new g.Sphere(32, 32, 1);\n\tctx.material = new g.Material(g.ShaderLib.simpleLit);\n\tctx.material.uniforms.materialDiffuse = [0, 0.8, 0, 0];\n\tctx.material.uniforms.materialSpecular = [0, 0, 0, 0];\n\tctx.material.uniforms.materialEmissive = [0, 1, 0, 1];\n\t\n\tctx.materialDead = new g.Material(g.ShaderLib.simpleLit);\n\tctx.materialDead.uniforms.materialDiffuse = [0, 0, 0, 0];\n\tctx.materialDead.uniforms.materialSpecular = [0, 0, 0, 0];\n\t\n\t// Keep track of two ticks worth of player data, interpolate between them\n\tctx.worldData.playersNew = {};\n\tctx.worldData.playersOld = {};\n\tctx.playersInterpolated = {};\n\tctx.timeOfLastUpdate = ctx.world.time;\n\t\n\tctx.worldData.timeNew = 1;\n\tctx.worldData.timeOld = 0;\n\t\n\t// Use average tick length when interpolating\n\tctx.averageTickLength = 100;\n\tctx.recentTicks = [100, 100, 100, 100, 100];\n\t\n\t// Copy what's needed for interpolation\n\tctx.worldData.copyForInterpolation = function(players) {\n\t\tvar copy = {};\n\t\tif (players) {\n\t\t\tObject.keys(players).forEach(function(v) {\n\t\t\t\tvar p = players[v];\n\t\t\t\tcopy[v] = {\n\t\t\t\t\tposition: p.position,\n\t\t\t\t\trotation: p.rotation\n\t\t\t\t};\n\t\t\t});\n\t\t}\n\t\treturn copy;\n\t};\n\t\n\tctx.playerConnected = function(player) {\n\t\tif (player.id != ctx.worldData.id) {\n\t\t\tinitEntity(ctx, player);\n\t\t}\n\t};\n\t\n\tctx.playerDisconnected = function(id) {\n\t\tif (id != ctx.worldData.id) {\n\t\t\tremoveEntity(ctx, id);\n\t\t}\n\t};\n\t\n\tctx.playerSpawned = function(player) {\n\t\tif (player.id != ctx.worldData.id) {\n\t\t\tg.SystemBus.emit('spawn');\n\t\t\tspawnEntity(ctx, player);\n\t\t} else {\n\t\t\tinitExisting(ctx);\n\t\t}\n\t};\n\t\n\tctx.playerKilled = function(killData) {\n\t\tif (killData.victim != ctx.worldData.id) {\n\t\t\tkillEntity(ctx, killData.victim);\n\t\t}\n\t};\n\t\n\tctx.playersUpdated = function() {\n\t\tcalculateAverageTickLength(ctx);\n\t};\n\t\n\tctx.init = function() {\n\t\tinitExisting(ctx);\n\t};\n\t\n\tg.SystemBus.addListener('server_init', ctx.init);\n\tg.SystemBus.addListener('players_updated', ctx.playersUpdated);\n\tg.SystemBus.addListener('player_spawned', ctx.playerSpawned);\n\tg.SystemBus.addListener('player_killed', ctx.playerKilled);\n\tg.SystemBus.addListener('player_connected', ctx.playerConnected);\n\tg.SystemBus.addListener('player_disconnected', ctx.playerDisconnected);\n\t\n};\n\n// Find and init any players that was there before us\nvar initExisting = function(ctx) {\n\tObject.keys(ctx.worldData.playersNew).forEach(function(v) {\n\t\tif (v != ctx.worldData.id && !ctx.oppEntities[v]) {\n\t\t\tinitEntity(ctx, ctx.worldData.playersNew[v]);\n\t\t\tspawnEntity(ctx, ctx.worldData.playersNew[v]);\n\t\t}\n\t});\n};\n\nvar calculateAverageTickLength = function(ctx) {\n\tctx.recentTicks.shift();\n\tctx.recentTicks.push(ctx.worldData.timeNew - ctx.worldData.timeOld);\n\tctx.averageTickLength = 0;\n\tctx.recentTicks.forEach(function(v) {\n\t\tctx.averageTickLength += v;\n\t});\n\tctx.averageTickLength /= ctx.recentTicks.length;\n};\n\nvar lerp = function(a, b, t) {\n\treturn a*(1-t) + b*t;\n};\n\nvar interpolatePlayers = function(ctx, t) {\n\tctx.playersInterpolated = {};\n\tObject.keys(ctx.worldData.playersNew).forEach(function(v) {\n\t\tif (ctx.worldData.playersOld[v]) {\n\t\t\tctx.playersInterpolated[v] = {\n\t\t\t\tposition: {\n\t\t\t\t\tx: lerp(ctx.worldData.playersOld[v].position.x, ctx.worldData.playersNew[v].position.x, t),\n\t\t\t\t\ty: lerp(ctx.worldData.playersOld[v].position.y, ctx.worldData.playersNew[v].position.y, t),\n\t\t\t\t\tz: lerp(ctx.worldData.playersOld[v].position.z, ctx.worldData.playersNew[v].position.z, t)\n\t\t\t\t}\n\t\t\t};\t\t\t\t\n\t\t} else {\n\t\t\tctx.playersInterpolated[v] = {\n\t\t\t\tposition: {\n\t\t\t\t\tx: ctx.worldData.playersNew[v].position.x,\n\t\t\t\t\ty: ctx.worldData.playersNew[v].position.y,\n\t\t\t\t\tz: ctx.worldData.playersNew[v].position.z\n\t\t\t\t}\t\t\t\t\n\t\t\t};\n\t\t}\n\t});\n};\n\nvar initEntity = function(ctx, player) {\n\tvar entity = ctx.world.createEntity(player.name, ctx.meshData, ctx.material).addToWorld();\n\tentity.hide();\n\tentity.setTranslation(0, 0, 0);\n\tctx.oppEntities[player.id] = entity;\n\tconsole.log('Initialized entity', entity);\n};\n\nvar removeEntity = function(ctx, id) {\n\tctx.oppEntities[id].removeFromWorld();\n\tdelete ctx.oppEntities[id];\n};\n\nvar spawnEntity = function(ctx, player) {\n\tconsole.log('Spawning entity', player.id);\n\tctx.oppEntities[player.id].setTranslation(\n\t\tplayer.position.x,\n\t\tplayer.position.y,\n\t\tplayer.position.z\n\t);\n\tctx.oppEntities[player.id].meshRendererComponent.materials[0] = ctx.material;\n\tctx.oppEntities[player.id].show();\n\t\n\t// To avoid weird interpolation\n\tctx.worldData.playersNew[player.id].position = player.position;\n\tctx.worldData.playersOld[player.id].position = player.position;\n};\n\nvar killEntity = function(ctx, id) {\n\tctx.oppEntities[id].meshRendererComponent.materials[0] = ctx.materialDead;\n\tctx.oppEntities[id].hide();\n};\n\nvar cleanup = function(args, ctx, goo) {\n\tg.SystemBus.removeListener('server_init', ctx.init);\n\tg.SystemBus.removeListener('players_updated', ctx.playersUpdated);\n\tg.SystemBus.removeListener('player_spawned', ctx.playerSpawned);\n\tg.SystemBus.removeListener('player_killed', ctx.playerKilled);\n\tg.SystemBus.removeListener('player_connected', ctx.playerConnected);\n\tg.SystemBus.removeListener('player_disconnected', ctx.playerDisconnected);\n\tObject.keys(ctx.oppEntities).forEach(function(v) {\n\t\tremoveEntity(ctx, v);\n\t});\n};\n\nvar update = function(args, ctx, goo) {\n\tctx.t = (ctx.world.time-ctx.worldData.timeNew)/ctx.averageTickLength;\n\tinterpolatePlayers(ctx, ctx.t);\n\tObject.keys(ctx.oppEntities).forEach(function(v) {\n\t\tif (ctx.playersInterpolated[v]) {\n\t\t\tctx.oppEntities[v].setTranslation(\n\t\t\t\tctx.playersInterpolated[v].position.x,\n\t\t\t\tctx.playersInterpolated[v].position.y, \n\t\t\t\tctx.playersInterpolated[v].position.z\n\t\t\t);\n\t\t}\n\t});\n};","name":"Opponent Entities","license":"CC0","created":"2014-12-09T10:18:22.894797+00:00","deleted":false,"modified":"2014-12-09T10:18:22.894820+00:00","dataModelVersion":2,"dependencies":{},"id":"15fbb7eae6814695a34bf8fd10415400.script"},"7c641ba033da44dcb00840da16155ff0.script":{"body":"var setup = function(args, ctx, goo) {\n\tctx.infoId = document.getElementById('info-id');\n\tctx.infoName = document.getElementById('info-name');\n\tctx.infoHealth = document.getElementById('info-health');\n\tctx.infoLatency = document.getElementById('info-latency');\n\tctx.infoKills = document.getElementById('info-kills');\n\tctx.infoDeaths = document.getElementById('info-deaths');\n\tctx.updateRate = 1;\n\tctx.lastUpdate = 0;\n};\n\nvar update = function(args, ctx, goo) {\n\tif (ctx.world.time - ctx.lastUpdate > ctx.updateRate) {\n\t\tif (ctx.worldData.id !== undefined && ctx.worldData.playersNew !== undefined) {\n\t\t\tctx.player = ctx.worldData.playersNew[ctx.worldData.id];\n\t\t\tctx.infoId.innerHTML = ctx.player.id;\n\t\t\tctx.infoName.innerHTML = ctx.player.name;\n\t\t\tctx.infoHealth.innerHTML = ctx.player.health;\n\t\t\tctx.infoLatency.innerHTML = ctx.player.latency;\n\t\t\tctx.infoKills.innerHTML = ctx.player.kills;\n\t\t\tctx.infoDeaths.innerHTML = ctx.player.deaths;\n\t\t}\n\t\tctx.lastUpdate = ctx.world.time;\n\t}\n};\n\n\n","name":"Info Panel","license":"CC0","created":"2014-12-09T10:18:26.296239+00:00","deleted":false,"modified":"2014-12-09T10:18:26.296262+00:00","dataModelVersion":2,"dependencies":{},"id":"7c641ba033da44dcb00840da16155ff0.script"},"facdb3e7d90d4fd486739c38c7ac6ac5.script":{"body":"/*\n\nRenders occluders\n\n*/\n\nvar parameters = [{\n\tkey: 'masterEntity',\n\ttype: 'entity'\n}];\n\nvar setup = function(args, ctx, goo) {\n\t\n\tctx.occluderEntities = [];\n\t\n\tctx.onConnect = function() {\n\t\tctx.worldData.occluders.forEach(function(v) {\n\t\t\tvar entity = goo.EntityUtils.clone(ctx.world, args.masterEntity).addToWorld();\n\t\t\tentity.setScale(v.radius, v.radius, v.radius);\n\t\t\tentity.setTranslation(v.position.x, v.position.y, v.position.z);\n\t\t\tctx.occluderEntities.push(entity);\n\t\t});\n\t};\n\t\n\tgoo.SystemBus.addListener('server_init', ctx.onConnect);\n};\n\nvar cleanup = function(args, ctx, goo) {\n\tgoo.SystemBus.removeListener('server_init', ctx.onConnect);\n\tctx.occluderEntities.forEach(function(v) {\n\t\tv.removeFromWorld();\n\t});\n};\n\n","name":"Occluders and Walls","license":"CC0","created":"2014-12-09T10:18:25.914889+00:00","deleted":false,"modified":"2014-12-09T10:18:25.914911+00:00","dataModelVersion":2,"dependencies":{},"id":"facdb3e7d90d4fd486739c38c7ac6ac5.script"},"c97bcb54014b4f76b48fc50e6adf33ae.script":{"body":"/*\n\nProvide a global function for displaying a simple message.\n\n*/\n\nvar setup = function(args, ctx, goo) {\n\n\tctx.status = document.getElementById('status');\n\tctx.statusMaj = document.getElementById('status-major');\n\tctx.statusMin = document.getElementById('status-minor');\n\t\n\tcenter(ctx);\n\t\n\tctx.worldData.showStatus = function(major, minor, duration) {\n\t\tvar dur = (duration !== undefined) ? duration : 9999999;\n\t\tctx.status.style.opacity = 1;\n\t\tctx.timeToKill = ctx.world.time + dur;\n\t\tvar min = (minor !== undefined) ? minor : '';\n\t\tctx.statusMaj.innerHTML = major;\t\n\t\tctx.statusMin.innerHTML = min;\n\t};\n\t\n\tctx.worldData.showStatus('Connecting...');\n};\n\nvar center = function(ctx) {\n\tctx.status.style.width = ctx.domElement.width/window.devicePixelRatio + 'px';\n};\n\nvar update = function(args, ctx, goo) {\n\tif (ctx.world.time > ctx.timeToKill) {\n\t\tctx.status.style.opacity -= 0.1;\n\t}\n};","name":"Status Panel","license":"CC0","created":"2014-12-09T10:18:22.354617+00:00","deleted":false,"modified":"2014-12-09T10:18:22.354643+00:00","dataModelVersion":2,"dependencies":{},"id":"c97bcb54014b4f76b48fc50e6adf33ae.script"},"cc72a19fb13b4b029636ca89efae4403.material":{"texturesMapping":{"DIFFUSE_MAP":{"enabled":true,"textureRef":"4d179364f676469ab50fe08e6fd2e9b9.texture"}},"flat":false,"cullState":{"frontFace":"CCW","enabled":true,"cullFace":"Back"},"uniforms":{"opacity":{"enabled":false,"value":1},"refractivity":{"enabled":true,"value":0},"materialAmbient":{"enabled":true,"value":[0.1,0.1,0.1,1]},"materialSpecular":{"enabled":true,"value":[0,0,0,1]},"fresnel":{"enabled":true,"value":0},"vertexColorAmount":{"enabled":true,"value":1},"materialSpecularPower":{"enabled":false,"value":0},"materialDiffuse":{"enabled":true,"value":[0.6895000000000001,1,0.13749999999999996,1]},"reflectivity":{"enabled":true,"value":0},"materialEmissive":{"enabled":true,"value":[1,1,1,1]},"discardThreshold":{"enabled":true,"value":0.1},"normalMultiplier":{"enabled":true,"value":1},"etaRatio":{"enabled":true,"value":-0.5},"wrapSettings":{"enabled":true,"value":[0,0]}},"name":"jcxEeeKcE.png Material","license":"CC0","created":"2014-12-09T10:18:21.674913+00:00","deleted":false,"wireframe":false,"dataModelVersion":2,"blendState":{"blendEquation":"AddEquation","blendSrc":"SrcAlphaFactor","blendDst":"OneMinusSrcAlphaFactor","blending":"CustomBlending"},"modified":"2014-12-09T10:18:21.674942+00:00","dualTransparency":false,"depthState":{"write":true,"enabled":true},"shaderRef":"GOO_ENGINE_SHADERS/uber","id":"cc72a19fb13b4b029636ca89efae4403.material","renderQueue":-1},"3213bc5745454190b3cab9ee15d88e3b.texture":{"wrapS":"Repeat","minFilter":"Trilinear","name":"tile.jpg","license":"CC0","flipY":true,"deleted":false,"magFilter":"Bilinear","created":"2014-12-09T10:18:24.486076+00:00","dataModelVersion":2,"modified":"2014-12-09T10:18:24.486098+00:00","repeat":[100,100],"imageRef":"91697bfea1d925a47713ee559251613925e98585.jpg","lodBias":0,"offset":[0,0],"generateMipmaps":true,"wrapT":"Repeat","id":"3213bc5745454190b3cab9ee15d88e3b.texture","anisotropy":1},"ff811e20fd8949059a7b00a16bc70a48.entity":{"name":"Z+ Wall","license":"CC0","tags":{},"deleted":false,"created":"2014-12-09T10:18:24.431543+00:00","dataModelVersion":2,"modified":"2014-12-09T10:18:24.431565+00:00","static":false,"components":{"transform":{"translation":[0,0,50],"scale":[100,10,1],"rotation":[0,180,0]},"meshRenderer":{"receiveShadows":true,"materials":{"8021ee4cb6f74e7c8a023d7d8ec9b231.material":{"materialRef":"8021ee4cb6f74e7c8a023d7d8ec9b231.material","sortValue":0}},"reflectable":true,"cullMode":"Dynamic","castShadows":true},"meshData":{"shape":"Quad"}},"hidden":false,"id":"ff811e20fd8949059a7b00a16bc70a48.entity"},"5069d7230bf948f2bce8aebc0af137cd.script":{"body":"var setup = function(args, ctx, goo) {\n\tctx.healthWrapper = document.getElementById('health-wrapper');\n\tctx.healthOuter = document.getElementById('health-outer');\n\tctx.healthInner = document.getElementById('health-inner');\n\t\n\tcenter(ctx);\n\tctx.worldData.displayHealth = function(health) {\n\t\tctx.healthInner.style.width = health*100 + '%';\t\n\t};\n};\n\nvar center = function(ctx) {\n\tctx.healthWrapper.style.width = ctx.domElement.width*window.devicePixelRatio + 'px';\n\tctx.healthWrapper.style.top = ctx.domElement.height*window.devicePixelRatio - 60*window.devicePixelRatio + 'px';\n};","name":"Health Bar","license":"CC0","created":"2014-12-09T10:18:24.679473+00:00","deleted":false,"modified":"2014-12-09T10:18:24.679495+00:00","dataModelVersion":2,"dependencies":{},"id":"5069d7230bf948f2bce8aebc0af137cd.script"},"e37286e8664948c88c3b7fe0e165619e.entity":{"name":"Health Bar","license":"CC0","created":"2014-12-09T10:18:26.579452+00:00","deleted":false,"modified":"2014-12-09T10:18:26.579473+00:00","dataModelVersion":2,"static":false,"components":{"html":{"imageRefs":{},"useTransformComponent":false,"innerHtml":"<style>\n\t\n\t#health-wrapper {\n\t\tposition: relative;\n\t\twidth: 1000px;\n\t\theight: 20px;\n\t\ttop: 600px;\n\t}\n\n\t#health-outer {\n\t\tposition: relative;\n\t\tmargin: 0 auto;\n\t\twidth: 75%;\n\t\theight: 100%;\n\t\tbackground-color: black;\n\t}\n\t\n\t#health-inner {\n\t\tposition: relative;\n\t\tmargin: 0 auto;\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\tbackground-color: red;\n\t\tfloat: left;\n\t}\n\t\n</style>\n\n<div id='health-wrapper'>\n\t<div id='health-outer'>\n\t\t<div id='health-inner'>\n\t\t</div>\n\t</div>\n</div>"},"transform":{"translation":[0,0,0],"scale":[1,1,1],"rotation":[0,0,0]}},"hidden":false,"id":"e37286e8664948c88c3b7fe0e165619e.entity"},"d1546a4dd10a47889863d5661418ee19.entity":{"name":"Default Lights","license":"CC0","tags":{},"deleted":false,"created":"2014-12-09T10:18:26.052220+00:00","modified":"2014-12-09T10:18:26.052243+00:00","dataModelVersion":2,"static":false,"components":{"transform":{"translation":[0,0,0],"scale":[1,1,1],"rotation":[0,0,0],"children":{"50516938902943138a6a4343635b147a.entity":{"entityRef":"50516938902943138a6a4343635b147a.entity","sortValue":0},"b79ebdf85d71413e8aa4ce83ef473a29.entity":{"entityRef":"b79ebdf85d71413e8aa4ce83ef473a29.entity","sortValue":1}}}},"hidden":false,"id":"d1546a4dd10a47889863d5661418ee19.entity"},"48ebfdbbb38944518ce1c90a68941be9.sound":{"name":"hitsound","license":"CC0","created":"2014-12-09T10:18:24.187031+00:00","deleted":false,"audioRefs":{"wav":"46dcbbc4984cac1e4afb67d376e6928f8425a124.wav"},"dataModelVersion":2,"modified":"2014-12-09T10:18:24.187055+00:00","volume":1,"id":"48ebfdbbb38944518ce1c90a68941be9.sound","loop":false},"4092bd2065d646e88e394090829e14d4.skybox":{"box":{"rightRef":"2bd7484651344980865f953b941b9264.texture","leftRef":"c3ce6b61777c4b838211a26c4551306d.texture","enabled":true,"bottomRef":"c7f6aa5a444b41acae22b7f8ee649c08.texture","frontRef":"68be5d7202654290b97aa79b097bfb65.texture","topRef":"98209e731f184ccfb3eba1ae86a117a6.texture","backRef":"4fcbdd6b85f6402bb0dc79ed7cd31408.texture"},"name":"Dystopia","license":"CC0","created":"2014-12-09T10:18:25.479724+00:00","deleted":false,"thumbnailRef":"6e2ec0ce7bcaffa4a34ca7f04c6100efd7d7470a.jpg","dataModelVersion":2,"originalAsset":{"version":"4a89431b37484f3d8298cf657676ac31","id":"fd0f1e7e94e54c56af900b76406b3440.skybox"},"modified":"2014-12-09T10:18:25.479746+00:00","id":"4092bd2065d646e88e394090829e14d4.skybox","originalLicense":"CC0"},"03749b918c6a4d4a9248c9b4e8c852a0.entity":{"name":"Gun Sound 3D","license":"CC0","tags":{},"deleted":false,"created":"2014-12-09T10:18:23.272777+00:00","dataModelVersion":2,"modified":"2014-12-09T10:18:23.272797+00:00","static":false,"components":{"sound":{"volume":1,"sounds":{"8c304342c23f4e789e9020bc2d3c9279.sound":{"soundRef":"8c304342c23f4e789e9020bc2d3c9279.sound","sortValue":2},"e455f1c251b84d53bb804ce0a675fa3e.sound":{"soundRef":"e455f1c251b84d53bb804ce0a675fa3e.sound","sortValue":1},"6475233573624485941e03c345b05f9a.sound":{"soundRef":"6475233573624485941e03c345b05f9a.sound","sortValue":0}}},"transform":{"translation":[0,0,0],"scale":[1,1,1],"rotation":[0,0,0]}},"hidden":false,"id":"03749b918c6a4d4a9248c9b4e8c852a0.entity"},"a3554adfce12433ca673b875aeca56a8.script":{"body":"/*\n\nThis is the main communication line between the client and the server.\nThe script connects to the WebSocket server and takes care of incoming messages.\n\nThe typical course of events:\n1. Recieve message from server.\n2. Update the client world data with the necessary stuff.\n3. Emit a message using the system bus.\n4. Other scripts/state machines listen to the bus and react.\n\n*/\n\n\nvar g;\nvar parameters = [{\n\tkey: 'host',\n\ttype: 'string',\n\tdefault: 'https://goo-shooter.herokuapp.com/'\n}];\n\nvar setup = function(args, ctx, goo) {\n\tg = goo;\n\tctx.host = (window.gooArenaWebSocketServerHost || args.host).replace(/^https/, 'wss').replace(/^http/, 'ws');\n\tctx.seq = 0;\n\tctx.worldData.serverReady = false;\n\tconnectWS(ctx);\n};\n\nvar initialize = function(ctx) {\n\t\n\t// Wrapper for sending a message to the server\n\tctx.worldData.pushMessage = function(message, data) {\n\t\tctx.ws.send(JSON.stringify({message: message, data: data}));\n\t\tctx.seq++;\n\t};\t\n\t\n\t// Wrapper for reciving and parsing a server message\n\tctx.ws.onmessage = function(messageString) {\n\t\tvar message = JSON.parse(messageString.data).message;\n\t\tvar data = JSON.parse(messageString.data).data;\n\t\thandleMessage(ctx, message, data);\n\t};\n\t\n};\n\n// Handle messages recieved from the server\nvar handleMessage = function(ctx, message, data) {\n\tswitch(message) {\n\t\tcase 's_init':\n\t\t\tctx.worldData.occluders = data.occluders;\n\t\t\tctx.worldData.constants = data.constants;\n\t\t\tctx.worldData.id = data.player.id;\n\t\t\tctx.worldData.name = data.player.name;\n\t\t\tctx.worldData.controlNumber = data.control_number;\n\t\t\tctx.worldData.playersNew = data.players;\n\t\t\tctx.worldData.playersOld = data.players;\n\t\t\tg.SystemBus.emit('server_init');\n\t\t\tbreak;\n\t\tcase 's_ping':\n\t\t\tctx.worldData.pushMessage('c_pong');\n\t\t\tbreak;\n\t\tcase 's_handled_deltas':\n\t\t\tctx.worldData.handledDeltas = data;\n\t\t\tg.SystemBus.emit('handled_deltas');\n\t\t\tbreak;\n\t\tcase 's_players':\n\t\t\t// New and old players\n\t\t\tctx.worldData.playersOld = ctx.worldData.copyForInterpolation(ctx.worldData.playersNew);\n\t\t\tctx.worldData.playersNew = data.players;\n\t\t\t// New and old update time\n\t\t\tctx.worldData.timeOld = ctx.worldData.timeNew;\n\t\t\tctx.worldData.timeNew = ctx.world.time;\n\t\t\t// Action stuff\n\t\t\tctx.worldData.shots = data.shots;\n\t\t\tctx.worldData.hits = data.hits;\n\t\t\tctx.worldData.kills = data.kills;\n\t\t\t// Reality check\n\t\t\tif (ctx.worldData.controlNumber != data.control_number) {\n\t\t\t\tconsole.error('Controls number do not match');\n\t\t\t\tconsole.error('Initial', ctx.worldData.controlNumber);\n\t\t\t\tconsole.error('Current', data.control_number);\n\t\t\t\tctx.worldData.showStatus('Server/client mismatch', 'Sorry, plese refresh');\n\t\t\t}\n\t\t\t// Ready for action\n\t\t\tg.SystemBus.emit('players_updated');\n\t\t\tbreak;\n\t\tcase 's_hit_target':\n\t\t\tg.SystemBus.emit('hit_target', data);\n\t\t\tbreak;\n\t\tcase 's_player_connected':\n\t\t\tg.SystemBus.emit('player_connected', data);\n\t\t\tbreak;\n\t\tcase 's_player_disconnected':\n\t\t\tg.SystemBus.emit('player_disconnected', data);\n\t\t\tbreak;\n\t\tcase 's_player_spawned':\n\t\t\tg.SystemBus.emit('player_spawned', data);\n\t\t\tif (data.id == ctx.worldData.id) {\n\t\t\t\tg.SystemBus.emit('i_spawned');\n\t\t\t}\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tconsole.error('Unknown message', message);\n\t\t\tbreak;\n\t}\t\n};\n\n\nvar cleanup = function(args, ctx, goo) {\n\tcloseWS(ctx);\n};\n\nvar connectWS = function(ctx) {\n\tctx.ws = new WebSocket(ctx.host);\n\tinitialize(ctx);\n};\n\nvar closeWS = function(ctx) {\n\tif (ctx.ws) {\n\t\tctx.ws.close();\n\t}\n};\n\n","name":"Connection and Messaging","license":"CC0","created":"2014-12-09T10:18:25.051417+00:00","deleted":false,"dataModelVersion":2,"modified":"2014-12-09T10:18:25.051440+00:00","dependencies":{},"id":"a3554adfce12433ca673b875aeca56a8.script"},"af91f807ff3b43f4b51d0099d1dc3190.script":{"body":"/*\n\nAsks the user for a name. Signals the mouse script that the\nto lock the mouse as well.\n\n*/\n\n\nvar setup = function(args, ctx, goo) {\n\t\n\tctx.nameInputWrapper = document.getElementById('name-input-wrapper');\n\tctx.nameInput = document.getElementById('name-input');\n\t\n\tctx.initInput = function() {\n\t\tctx.worldData.showStatus('Connected!', 'Enter name and press ENTER');\n\t\t\n\t\tctx.nameInput.value = ctx.worldData.name;\n\t\t// Timeout to make auto-selection work\n\t\tsetTimeout(function() {\n\t\t\tctx.nameInput.focus();\n\t\t\tctx.nameInput.select();\t\n\t\t}, 100);\n\t\t\n\t\tctx.nameInputWrapper.style.width = ctx.domElement.width/window.devicePixelRatio + 'px';\n\t\tctx.nameInputWrapper.style.display = 'block';\n\t};\n\tgoo.SystemBus.addListener('server_init', ctx.initInput);\n\t\n\tctx.windowListeners = {\n\t\tkeyup: function(evt) {\n\t\t\tif (evt.keyCode === 13) { \n\t\t\t\t// ENTER key\n\t\t\t\t\n\t\t\t\tchangeName(ctx, ctx.nameInput.value);\n\t\t\t\tctx.nameInputWrapper.style.display = 'none';\n\t\t\t\tremoveWindowListeners(ctx);\n\t\t\t\t\n\t\t\t\t// Take the opportunity to lock the mouse,\n\t\t\t\t// as this has to happen on a user triggered event\n\t\t\t\tgoo.SystemBus.emit('lock_mouse');\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t};\n\tObject.keys(ctx.windowListeners).forEach(function(v) {\n\t\twindow.addEventListener(v, ctx.windowListeners[v]);\n\t});\n\t\n};\n\nvar removeWindowListeners = function(ctx) {\n\tObject.keys(ctx.windowListeners).forEach(function(v) {\n\t\twindow.removeEventListener(v, ctx.windowListeners[v]);\n\t});\n\tdelete ctx.windowListeners;\n};\n\nvar cleanup = function(args, ctx, goo) {\n\tgoo.SystemBus.removeListener('server_init', ctx.initInput);\n\tctx.nameInputWrapper.style.display = 'none';\n\tif (ctx.windowListeners) removeWindowListeners(ctx);\n};\n\nvar changeName = function(ctx, name) {\n\tif (ctx.worldData.id !== undefined && ctx.worldData.playersNew !== undefined) {\n\t\tctx.worldData.pushMessage('c_name', name);\n\t}\n};\n","name":"Name prompt","license":"CC0","created":"2014-12-09T10:18:21.919387+00:00","deleted":false,"modified":"2014-12-09T10:18:21.919411+00:00","dataModelVersion":2,"id":"af91f807ff3b43f4b51d0099d1dc3190.script"},"d751ea7b0cfd4a5ea99453d0b0efa1f0.sound":{"name":"own_gun","license":"CC0","created":"2014-12-09T10:18:22.543737+00:00","deleted":false,"audioRefs":{"mp3":"fa1baca4a8742746a050779badc857e8d6a2bde3.mp3"},"dataModelVersion":2,"modified":"2014-12-09T10:18:22.543758+00:00","volume":1,"id":"d751ea7b0cfd4a5ea99453d0b0efa1f0.sound","loop":false},"c12c0e3deb514efa90aec61502fffa05.entity":{"name":"Blood Quad","license":"CC0","tags":{},"deleted":false,"created":"2014-12-09T10:18:26.349897+00:00","dataModelVersion":2,"modified":"2014-12-09T10:18:26.349919+00:00","static":false,"components":{"meshRenderer":{"receiveShadows":true,"materials":{"5d3164c6dd084c64937d099f313a97b6.material":{"materialRef":"5d3164c6dd084c64937d099f313a97b6.material","sortValue":0}},"reflectable":true,"cullMode":"Dynamic","castShadows":true},"transform":{"translation":[0,0,-1.4],"scale":[10,10,10],"rotation":[0,0,0]},"stateMachine":{"machines":{"c69bb6c6ab88402893cfcfb395011452.machine":{"machineRef":"c69bb6c6ab88402893cfcfb395011452.machine","sortValue":0}}},"meshData":{"shape":"Quad"}},"hidden":false,"id":"c12c0e3deb514efa90aec61502fffa05.entity"},"77d6091104464320884290009c32be04.machine":{"name":"Behavior 2","license":"CC0","created":"2014-12-09T10:18:22.308874+00:00","deleted":false,"modified":"2014-12-09T10:18:22.308905+00:00","dataModelVersion":2,"states":{"583c610f8d4c40f0bb51e01892010859.state":{"sortValue":0,"transitions":{"4ffcfc4930644252a740894c45bb1742.transition":{"name":"To","targetState":"acba6cce903540aca5bab478dba4ba12.state","sortValue":4,"id":"4ffcfc4930644252a740894c45bb1742.transition"}},"name":"idle","actions":{"04e355a1a885417481f8b451c4430517.action":{"name":"Listen","type":"Transition on Message","options":{"transitions":{"transition":"4ffcfc4930644252a740894c45bb1742.transition"},"channel":"i_am_dead"},"sortValue":4,"id":"04e355a1a885417481f8b451c4430517.action"}},"id":"583c610f8d4c40f0bb51e01892010859.state"},"acba6cce903540aca5bab478dba4ba12.state":{"id":"acba6cce903540aca5bab478dba4ba12.state","transitions":{"3c72fa85858d40d8a062d28cb910354c.transition":{"name":"On Completion","targetState":"583c610f8d4c40f0bb51e01892010859.state","sortValue":0,"id":"3c72fa85858d40d8a062d28cb910354c.transition"}},"name":"play_dead","actions":{"7cfa4c4c71944b80a2d2b11ebd0cd9b6.action":{"name":"Sound Fade In","type":"Sound Fade In","options":{"sound":"d10e0e1b76544af4a1d7ffbf0f93f7b5.sound","transitions":{"complete":"3c72fa85858d40d8a062d28cb910354c.transition"},"time":"1"},"sortValue":0,"id":"7cfa4c4c71944b80a2d2b11ebd0cd9b6.action"}},"sortValue":5}},"initialState":"583c610f8d4c40f0bb51e01892010859.state","id":"77d6091104464320884290009c32be04.machine"},"c000042ac5a94fd695acce743602bbf7.script":{"body":"var g;\nvar setup = function(args, ctx, goo) {\n\tg = goo;\n\t\n\tctx.shotSoundEntity = args.shotSoundEntity;\n\tctx.boomSoundEntity = args.boomSoundEntity;\n\t\n\tctx.n = { \n\t\tshot: ctx.shotSoundEntity.soundComponent.sounds.length,\n\t\tboom: ctx.boomSoundEntity.soundComponent.sounds.length\n\t};\n\tctx.active = {\n\t\tshot: 0,\n\t\tboom: 0\n\t};\n\n\tctx.opponentShot = function(shotData) {\n\t\tvar point = new g.Vector3(shotData.source.x, shotData.source.y, shotData.source.z);\n\t\tctx.shotSoundEntity.setTranslation(point);\n\t\tctx.shotSoundEntity.soundComponent.sounds[ctx.active.shot].play();\n\t\tctx.active.shot++;\n\t\tctx.active.shot %= ctx.n.shot;\n\t};\n\tg.SystemBus.addListener('opponent_shot', ctx.opponentShot);\n\t\n\tctx.playerKilled = function(killData) {\n\t\tvar point = new g.Vector3(killData.point.x, killData.point.y, killData.point.z)\n\t\tctx.boomSoundEntity.setTranslation(point);\n\t\tctx.boomSoundEntity.soundComponent.sounds[ctx.active.boom].play();\n\t\tctx.active.boom++;\n\t\tctx.active.boom %= ctx.n.boom;\n\t};\n\tg.SystemBus.addListener('player_killed', ctx.playerKilled);\n};\n\n\nvar cleanup = function(args, ctx, goo) {\n\tg.SystemBus.removeListener('opponent_shot', ctx.opponentShot);\n\tg.SystemBus.removeListener('player_killed', ctx.playerKilled);\n};\n\nvar update = function(args, ctx, goo) {\n\n};\n\nvar parameters = [{\n\tkey: 'shotSoundEntity',\n\ttype: 'entity'\n}, {\n\tkey: 'boomSoundEntity',\n\ttype: 'entity'\n}];","name":"Sound 3D","license":"CC0","created":"2014-12-09T10:18:22.752075+00:00","deleted":false,"modified":"2014-12-09T10:18:22.752097+00:00","dataModelVersion":2,"id":"c000042ac5a94fd695acce743602bbf7.script"},"39fef29a8296450ebb61ce4c5bd80d34.sound":{"name":"Dinosaur Roar-SoundBible.com-605392672","license":"CC0","created":"2014-12-09T10:18:22.447928+00:00","deleted":false,"audioRefs":{"mp3":"a3e8e51f5759f231eaaaf2929cec976505897dfb.mp3"},"dataModelVersion":2,"modified":"2014-12-09T10:18:22.447956+00:00","volume":1,"id":"39fef29a8296450ebb61ce4c5bd80d34.sound","loop":false},"8f6340ded0104beea74f0c3d18d64565.entity":{"name":"Overhead cam 2","license":"CC0","tags":{},"deleted":false,"created":"2014-12-09T10:18:23.568684+00:00","dataModelVersion":2,"modified":"2014-12-09T10:18:23.568706+00:00","static":false,"components":{"camera":{"fov":45,"lockedRatio":false,"far":1000,"projectionMode":"Perspective","near":1,"aspect":1,"size":100},"transform":{"translation":[0,33.43862533569336,71.12820434570312],"scale":[1,1,1],"rotation":[-33.1087750959357,0,0]}},"hidden":false,"id":"8f6340ded0104beea74f0c3d18d64565.entity"},"c285b989b9d84501a8c7493adfae9fc5.script":{"body":"/*\n\n\tSince shots, hits and kills are all accumulated in arrays,\n\tthis script is needed to sift through these arrays and pass\n\tany interesting info along to other scripts.\n\n*/\n\n\nvar g;\n\nvar setup = function(args, ctx, goo) {\n\tg = goo;\n\tctx.worldData.shots = [];\n\tctx.worldData.hits = [];\n\tctx.worldData.kills = [];\n\n\tctx.playersUpdated = function() {\n\t\tcheckForShots(ctx);\n\t\tcheckForHits(ctx);\n\t\tcheckForKills(ctx);\n\t};\n\t\n\tg.SystemBus.addListener('players_updated', ctx.playersUpdated);\n\n};\n\nvar cleanup = function(args, ctx, goo) {\n\tg.SystemBus.removeListener('players_updated', ctx.playersUpdated);\n};\n\nvar checkForShots = function(ctx) {\n\tctx.worldData.shots.forEach(function(v) {\n\t\tg.SystemBus.emit('shot', v);\n\t\tif (v.shooter != ctx.worldData.id) {\n\t\t\tg.SystemBus.emit('opponent_shot', v);\n\t\t}\n\t});\n\tctx.worldData.shots = [];\n};\n\nvar checkForHits = function(ctx) {\n\tctx.worldData.hits.forEach(function(v) {\n\t\tif (v.victim == ctx.worldData.id) {\n\t\t\tg.SystemBus.emit('i_am_hit');\n\t\t} else if (v.shooter != ctx.worldData.id) {\n\t\t\tg.SystemBus.emit('other_hit', v);\n\t\t}\n\t});\t\n\tctx.worldData.hits = [];\n};\n\nvar checkForKills = function(ctx) {\n\tctx.worldData.kills.forEach(function(v) {\n\t\tif (v.victim == ctx.worldData.id) {\n\t\t\tg.SystemBus.emit('i_am_dead');\n\t\t} else if (v.shooter == ctx.worldData.id) {\n\t\t\tctx.worldData.showStatus('You killed ' + ctx.worldData.playersNew[v.victim].name, '', 2);\n\t\t}\n\t\tg.SystemBus.emit('player_killed', v);\n\t});\n\tctx.worldData.kills = [];\n};","name":"Shots, Hits and Kills","license":"CC0","created":"2014-12-09T10:18:26.151397+00:00","deleted":false,"modified":"2014-12-09T10:18:26.151418+00:00","dataModelVersion":2,"dependencies":{},"id":"c285b989b9d84501a8c7493adfae9fc5.script"},"8d75e94c49b74ca4bfd7268ff3fb09ab.entity":{"name":"Sounds","license":"CC0","tags":{},"deleted":false,"created":"2014-12-09T10:18:21.525227+00:00","dataModelVersion":2,"modified":"2014-12-09T10:18:21.525247+00:00","static":false,"components":{"sound":{"volume":1,"sounds":{"6eec7c3a472a43579715267106ef35ea.sound":{"soundRef":"6eec7c3a472a43579715267106ef35ea.sound","sortValue":5},"d673646b2a114245b02e9062c9d95c53.sound":{"soundRef":"d673646b2a114245b02e9062c9d95c53.sound","sortValue":1},"d751ea7b0cfd4a5ea99453d0b0efa1f0.sound":{"soundRef":"d751ea7b0cfd4a5ea99453d0b0efa1f0.sound","sortValue":7},"7f5310e3c80b4deeb4e9f622d174558c.sound":{"soundRef":"7f5310e3c80b4deeb4e9f622d174558c.sound","sortValue":0},"48ebfdbbb38944518ce1c90a68941be9.sound":{"soundRef":"48ebfdbbb38944518ce1c90a68941be9.sound","sortValue":2},"e5427b9b2a1249838fd4f25aa3c61125.sound":{"soundRef":"e5427b9b2a1249838fd4f25aa3c61125.sound","sortValue":6}}},"transform":{"translation":[0,1.5619947910308838,-3.6989047527313232],"scale":[1,1,1],"rotation":[0,0,0]},"stateMachine":{"machines":{"2dd7b84e79df492385b93e9c04926a0f.machine":{"machineRef":"2dd7b84e79df492385b93e9c04926a0f.machine","sortValue":0}}}},"hidden":false,"id":"8d75e94c49b74ca4bfd7268ff3fb09ab.entity"},"8c304342c23f4e789e9020bc2d3c9279.sound":{"name":"opp_gun","license":"CC0","created":"2014-12-09T10:18:26.490729+00:00","deleted":false,"audioRefs":{"mp3":"b88dc2d382ad42e5bb11822d0e366eaa1a5a364f.mp3"},"dataModelVersion":2,"modified":"2014-12-09T10:18:26.490750+00:00","volume":0.5,"id":"8c304342c23f4e789e9020bc2d3c9279.sound","loop":false},"8f2eda3b8dac4902b4e19e5f5a75e2c0.entity":{"name":"Default Camera","license":"CC0","created":"2014-12-09T10:18:26.100371+00:00","deleted":false,"tags":{},"dataModelVersion":2,"modified":"2014-12-09T10:49:58.201958+00:00","static":false,"components":{"camera":{"fov":45,"lockedRatio":false,"far":1000,"followEditorCam":true,"projectionMode":"Perspective","near":1,"aspect":1,"size":5},"transform":{"rotation":[-7.654645989897879,14.633236858066638,0],"scale":[1,1,1],"translation":[1.219107812793741,0.6485645047269983,4.669121599594914]},"script":{"scripts":{"fe21bb9478404a1281326d976585dc47.scriptinstance":{"scriptRef":"GOO_ENGINE_SCRIPTS/OrbitNPanControlScript","options":{"maxAscent":89.95,"whenUsed":true,"zoomSpeed":1,"clampAzimuth":false,"maxAzimuth":270,"minZoomDistance":1,"enabled":true,"minAzimuth":90,"minAscent":-89,"lookAtDistance":4.869040592130064,"drag":0.9,"dragButton":"Left","panButton":"Right","orbitSpeed":0.005,"smoothness":0.4,"maxZoomDistance":1000},"id":"fe21bb9478404a1281326d976585dc47.scriptinstance","sortValue":0,"name":"OrbitNPanControlScript"}}}},"hidden":false,"id":"8f2eda3b8dac4902b4e19e5f5a75e2c0.entity"},"2bd7484651344980865f953b941b9264.texture":{"wrapS":"Repeat","minFilter":"BilinearNoMipMaps","imageRef":"bfe2a49cc6fca30195f223b1c3411e2798e2bc9e.jpg","license":"CC0","flipY":false,"deleted":false,"name":"texture_45","magFilter":"Bilinear","created":"2014-12-09T10:18:24.912525+00:00","dataModelVersion":2,"modified":"2014-12-09T10:18:24.912548+00:00","repeat":[0,0],"anisotropy":1,"offset":[0,0],"id":"2bd7484651344980865f953b941b9264.texture","generateMipmaps":true,"originalLicense":"CC0","wrapT":"Repeat"},"e455f1c251b84d53bb804ce0a675fa3e.sound":{"name":"opp_gun","license":"CC0","created":"2014-12-09T10:18:22.599464+00:00","deleted":false,"audioRefs":{"mp3":"b88dc2d382ad42e5bb11822d0e366eaa1a5a364f.mp3"},"dataModelVersion":2,"modified":"2014-12-09T10:18:22.599486+00:00","volume":0.5,"id":"e455f1c251b84d53bb804ce0a675fa3e.sound","loop":false},"b79ebdf85d71413e8aa4ce83ef473a29.entity":{"name":"Directional 2","license":"CC0","tags":{},"deleted":false,"created":"2014-12-09T10:18:22.151532+00:00","modified":"2014-12-09T10:18:22.151551+00:00","dataModelVersion":2,"static":false,"components":{"light":{"direction":[0,0,0],"shadowCaster":false,"color":[1,1,1,1],"intensity":0.9,"range":60,"specularIntensity":0.29,"penumbra":5,"angle":30,"type":"DirectionalLight","shadowSettings":{"fov":30,"darkness":1,"far":60,"near":1,"resolution":[256,256],"shadowType":"Basic","size":100}},"transform":{"rotation":[-84.1203229499319,-176.17371937553685,-60.07154107101883],"scale":[1,1,1],"translation":[-22.148197174072266,11.600000381469727,-58.07421112060547]}},"hidden":false,"id":"b79ebdf85d71413e8aa4ce83ef473a29.entity"},"95fe2687cf6e4f5384ee638ea46d539f.entity":{"name":"Score Panel","license":"CC0","tags":{},"deleted":false,"created":"2014-12-09T10:18:23.995219+00:00","modified":"2014-12-09T10:18:23.995244+00:00","dataModelVersion":2,"static":false,"components":{"html":{"imageRefs":{},"useTransformComponent":false,"innerHtml":"<style>\n\t#scores-wrapper {\n\t\tposition: absolute;\n\t\tfont-family: 'Trebuchet MS';\n\t\tcolor: #fff;\n\t\tfont-size: 28;\n\t\ttop: 250px;\n\t\twidth: 800px;\n\t}\n\t\n\t#scores-outer {\n\t\tdisplay: block;\n\t\twidth: 500px;\n\t\tmargin: 0 auto;\n\t}\n\t\n\t#scores-table {\n\t\tposition: relative;\n\t\tborder-collapse: collapse;\n\t\ttext-align: left;\n\t\twidth: 500px;\n\t\tdisplay: none;\n\t\ttable-layout: fixed;\n\t}\n\t\n\ttr.header {\n\t\tbackground-color: #000;\n\t}\n\t\n\ttr.even {\n\t\tbackground-color: #444;\n\t}\n\t\n\ttr.odd {\n\t\tbackground-color: #666;\n\t}\n\t\n</style>\n\n\n<div id='scores-wrapper'>\n\t<div id='scores-outer'>\n\t\t<table id='scores-table'>\n\t\t\t<tr class='header'>\n\t\t\t\t<th>Name</th>\n\t\t\t\t<th>Kills</th>\n\t\t\t\t<th>Deaths</th>\n\t\t\t</tr>\n\t\t</table>\n\t</div>\n</div>"},"transform":{"translation":[0,0,0],"scale":[1,1,1],"rotation":[0,0,0]}},"hidden":false,"id":"95fe2687cf6e4f5384ee638ea46d539f.entity"},"c69bb6c6ab88402893cfcfb395011452.machine":{"name":"Behavior","license":"CC0","created":"2014-12-09T10:18:22.851302+00:00","deleted":false,"modified":"2014-12-09T10:18:22.851333+00:00","dataModelVersion":2,"states":{"c771676581a54a138cf8bce264a4c3ee.state":{"actions":{"9ae7078e961d4a798b256be2cb2c113a.action":{"options":{"easing2":"In","to":1,"transitions":{"complete":"dbebb60b01284863a6b813a37a070b65.transition"},"easing1":"Linear","time":10},"type":"Tween Opacity","id":"9ae7078e961d4a798b256be2cb2c113a.action","sortValue":0,"name":"Tween Opacity"},"54106441c3ce4e3582d763d9050cc176.action":{"options":{"transitions":{"transition":"ce8d5fc82ba449ca954a50a293e2b7e3.transition"},"channel":"i_am_dead"},"type":"Transition on Message","id":"54106441c3ce4e3582d763d9050cc176.action","sortValue":1,"name":"Listen"}},"transitions":{"dbebb60b01284863a6b813a37a070b65.transition":{"targetState":"82353c01632540f7bf0dadbae3d786b4.state","id":"dbebb60b01284863a6b813a37a070b65.transition","sortValue":0,"name":"On Completion"},"ce8d5fc82ba449ca954a50a293e2b7e3.transition":{"targetState":"8382b8ade8a648c087821a135c721b68.state","id":"ce8d5fc82ba449ca954a50a293e2b7e3.transition","sortValue":1,"name":"To"}},"id":"c771676581a54a138cf8bce264a4c3ee.state","sortValue":1,"name":"flash in"},"86e4722fd8604b78b32ed70bd00942b9.state":{"actions":{"5c797117153c4b308e75e8451460bb56.action":{"id":"5c797117153c4b308e75e8451460bb56.action","type":"Transition on Message","name":"Listen","sortValue":3,"options":{"transitions":{"transition":"d5253c02815640f88cd5f731f6c43a15.transition"},"channel":"spawn_self"}},"fd4bea6fb7e442859c033f44fabec2a1.action":{"options":{"transitions":{"transition":"08b0c942f9ed4a89968e396ebf779896.transition"},"channel":"i_am_hit"},"type":"Transition on Message","id":"fd4bea6fb7e442859c033f44fabec2a1.action","sortValue":1,"name":"Listen"},"99af136c85d04d3f8d23fa456642a213.action":{"options":{"transitions":{"transition":"22e6bc1caf554cd397eb9049ba51f007.transition"},"channel":"i_am_dead"},"type":"Transition on Message","id":"99af136c85d04d3f8d23fa456642a213.action","sortValue":4,"name":"Listen"}},"transitions":{"d5253c02815640f88cd5f731f6c43a15.transition":{"id":"d5253c02815640f88cd5f731f6c43a15.transition","name":"To","sortValue":3,"targetState":"82353c01632540f7bf0dadbae3d786b4.state"},"22e6bc1caf554cd397eb9049ba51f007.transition":{"targetState":"8382b8ade8a648c087821a135c721b68.state","id":"22e6bc1caf554cd397eb9049ba51f007.transition","sortValue":4,"name":"To"},"08b0c942f9ed4a89968e396ebf779896.transition":{"targetState":"c771676581a54a138cf8bce264a4c3ee.state","id":"08b0c942f9ed4a89968e396ebf779896.transition","sortValue":1,"name":"To"}},"id":"86e4722fd8604b78b32ed70bd00942b9.state","sortValue":0,"name":"idle"},"82353c01632540f7bf0dadbae3d786b4.state":{"actions":{"4302f9571497413db5db1980371d6367.action":{"options":{"transitions":{"transition":"436b694651ff42fabd573a032c394bec.transition"},"channel":"i_am_dead"},"type":"Transition on Message","id":"4302f9571497413db5db1980371d6367.action","sortValue":1,"name":"Listen"},"5472a58658ef40e9b4cebe289221cb44.action":{"options":{"easing2":"In","to":0,"transitions":{"complete":"5a1a20d3ff394bd4a4af85f764a50932.transition"},"easing1":"Linear","time":500},"type":"Tween Opacity","id":"5472a58658ef40e9b4cebe289221cb44.action","sortValue":0,"name":"Tween Opacity"}},"transitions":{"5a1a20d3ff394bd4a4af85f764a50932.transition":{"targetState":"86e4722fd8604b78b32ed70bd00942b9.state","id":"5a1a20d3ff394bd4a4af85f764a50932.transition","sortValue":0,"name":"On Completion"},"436b694651ff42fabd573a032c394bec.transition":{"id":"436b694651ff42fabd573a032c394bec.transition","targetState":"8382b8ade8a648c087821a135c721b68.state","sortValue":1,"name":"To"}},"id":"82353c01632540f7bf0dadbae3d786b4.state","sortValue":2,"name":"flash out"},"8382b8ade8a648c087821a135c721b68.state":{"id":"8382b8ade8a648c087821a135c721b68.state","transitions":{"e885f5a4075c44e28d54912f087991ae.transition":{"name":"On Completion","targetState":"86e4722fd8604b78b32ed70bd00942b9.state","sortValue":0,"id":"e885f5a4075c44e28d54912f087991ae.transition"}},"name":"remove","actions":{"8bce48ca5df54a4fa0120babeba132ab.action":{"name":"Tween Opacity","type":"Tween Opacity","options":{"easing2":"In","to":0,"transitions":{"complete":"e885f5a4075c44e28d54912f087991ae.transition"},"easing1":"Linear","time":1},"sortValue":0,"id":"8bce48ca5df54a4fa0120babeba132ab.action"}},"sortValue":3}},"initialState":"86e4722fd8604b78b32ed70bd00942b9.state","id":"c69bb6c6ab88402893cfcfb395011452.machine"},"7f5310e3c80b4deeb4e9f622d174558c.sound":{"name":"deagle-1","license":"CC0","created":"2014-12-09T10:18:24.143451+00:00","deleted":false,"audioRefs":{"wav":"02c34e8664d3fec5332f0dd0bb4a7a14c003a043.wav"},"dataModelVersion":2,"modified":"2014-12-09T10:18:24.143478+00:00","volume":1,"id":"7f5310e3c80b4deeb4e9f622d174558c.sound","loop":false},"c6ff4413cc27419ba272d3ce5c1fc07f.script":{"body":"/*\n\nSimple (and not very efficient) \"particle\" effects using \nentities. A good target for some fancy development!\n\nNow also with lasers!\n\n*/\n\nvar g;\nvar pl;\nvar setup = function(args, ctx, goo) {\n\tconsole.clear();\n\tg = goo;\n\t\n\tctx.lines = [];\n\tconsole.log('Requiring polyline');\n\trequire(['goo/geometrypack/PolyLine'], function(PolyLine) {\n\t\tconsole.log('PolyLine loaded');\n\t\tpl = PolyLine;\t\n\t});\n\t\n\tctx.numTypes = 3;\n\t\n\tctx.BLOOD = 0,\n\tctx.DEATH = 1,\n\tctx.FLASH = 2,\n\t\n\tctx.numEmitters = [5, 3, 5];\n\tctx.numEntities = [5, 15, 5];\n\tctx.activeEmitter = [0, 0, 0];\n\tctx.timeToLive = [0.5, 2, 0.2];\n\tctx.acceleration = [-15, -5, -2];\n\tctx.emitters = [[], [], []];\n\t\n\tctx.meshData = [\n\t\tnew g.Sphere(8, 8, 0.3),\n\t\tnew g.Sphere(8, 8, 0.6),\n\t\tnew g.Sphere(8, 8, 0.2)\n\t];\n\t\n\tctx.materials = [\n\t\tnew g.Material(g.ShaderLib.simpleLit),\n\t\tnew g.Material(g.ShaderLib.simpleLit),\n\t\tnew g.Material(g.ShaderLib.simpleLit)\n\t];\n\t\n\tctx.materials[ctx.BLOOD].uniforms.materialDiffuse = [0.8, 0, 0, 1];\n\tctx.materials[ctx.BLOOD].uniforms.materialSpecular = [0, 0, 0, 0];\n\tctx.materials[ctx.BLOOD].uniforms.materialEmissive = [1, 0, 0, 1];\n\t\n\tctx.materials[ctx.DEATH].uniforms.materialDiffuse = [0, 0, 0, 1];\n\tctx.materials[ctx.DEATH].uniforms.materialSpecular = [0, 0, 0, 0];\n\tctx.materials[ctx.DEATH].uniforms.materialEmissive = [1, 0.5, 0, 0];\n\t\n\tctx.materials[ctx.FLASH].uniforms.materialDiffuse = [1, 1, 0, 1];\n\tctx.materials[ctx.FLASH].uniforms.materialSpecular = [0, 1, 0, 0];\n\tctx.materials[ctx.FLASH].uniforms.materialEmissive = [1, 1, 0, 1];\n\n\tinitEmitters(ctx);\n\t\n\tctx.launchBlood = function(hitData) {\n\t\temit(ctx, ctx.BLOOD, new g.Vector3(hitData.point.x, hitData.point.y, hitData.point.z));\n\t};\n\tg.SystemBus.addListener('hit_target', ctx.launchBlood);\n\tg.SystemBus.addListener('other_hit', ctx.launchBlood);\n\t\n\tctx.launchDeath = function(killData) {\n\t\temit(ctx, ctx.DEATH, new g.Vector3(killData.point.x, killData.point.y, killData.point.z));\n\t};\n\tg.SystemBus.addListener('player_killed', ctx.launchDeath);\n\n\tctx.launchFlash = function(shotData) {\n\t\tvar point = new g.Vector3(shotData.source.x, shotData.source.y, shotData.source.z);\n\t\tvar direction = new g.Vector3(shotData.direction.x, shotData.direction.y, shotData.direction.z);\n\t\tdirection.normalize();\n\t\tpoint.add(direction);\n\t\t//emit(ctx, ctx.FLASH, point);\n\t};\n\tg.SystemBus.addListener('opponent_shot', ctx.launchFlash);\n\t\n\t\n\tctx.lineMaterial = new g.Material(goo.ShaderLib.simpleLit);\n\tctx.lineMaterial.uniforms.materialDiffuse = [0, 1, 0, 1];\n\tctx.lineMaterial.uniforms.materialEmissive = [0, 1, 0, 1];\n    ctx.lineMaterial.cullState.enabled = false;\n    \n    ctx.ttl = 5;\n    ctx.drawLine = function(shotData) {\n\t\tvar point = new g.Vector3(shotData.source.x, shotData.source.y, shotData.source.z);\n\t\t// HACK to make own shots visible (aim height and sphere pos don't match)\n\t\t// TODO less hack\n\t\tif (shotData.shooter < 10000) {\n\t\t\tpoint.sub(new g.Vector3(0, 0.5, 0));\n\t\t}\n\t\tvar target = new g.Vector3(shotData.impact.x, shotData.impact.y, shotData.impact.z);\n\t\tdrawLine(ctx, point, target);\n    };\n    g.SystemBus.addListener('shot', ctx.drawLine);\n    \n};\n\nvar cleanup = function(args, ctx, goo) {\n\tremoveAllEmitters(ctx);\n\tg.SystemBus.removeListener('hit_target', ctx.launchBlood);\n\tg.SystemBus.removeListener('other_hit', ctx.launchBlood);\n\tg.SystemBus.removeListener('player_killed', ctx.launchDeath);\n\tg.SystemBus.removeListener('flash', ctx.launchFlash);\n\tg.SystemBus.removeListener('shot', ctx.drawLine);\n\tctx.lines.forEach(function(v) {\n\t\tv.entity.removeFromWorld();\n\t});\n};\n\nvar initEmitters = function(ctx) {\n\tfor (var i=0; i<ctx.numTypes; i++) {\n\t\tfor (var j=0; j<ctx.numEmitters[i]; j++) {\n\t\t\tvar emitter = {\n\t\t\t\talive: false,\n\t\t\t\ttimeToLive: -1,\n\t\t\t\tentities: initEntities(ctx, i)\n\t\t\t};\n\t\t\tctx.emitters[i].push(emitter);\n\t\t}\n\t}\n\tconsole.log(ctx.emitters);\n};\n\nvar initEntities = function(ctx, type) {\n\tvar e = [];\n\tfor (var i=0; i<ctx.numEntities[type]; i++) {\n\t\te.push(ctx.world.createEntity(ctx.meshData[type], ctx.materials[type]));\n\t}\n\treturn e;\n};\n\nvar emit = function(ctx, type, point) {\n\tctx.emitters[type][ctx.activeEmitter[type]].alive = true;\n\tctx.emitters[type][ctx.activeEmitter[type]].timeToLive = ctx.timeToLive[type];\n\tctx.emitters[type][ctx.activeEmitter[type]].entities.forEach(function(v) {\n\t\tv.setAttribute('velocity', new g.Vector3(\n\t\t\t4*(-0.5+Math.random()), \n\t\t\tMath.random()*5,\n\t\t\t4*(-0.5+Math.random())\n\t\t));\n\t\tv.addToWorld();\n\t\tv.setTranslation(point);\n\t});\n\tctx.activeEmitter[type]++;\n\tctx.activeEmitter[type] %= ctx.numEmitters[type];\n};\n\nvar updateEmitter = function(ctx, type, index) {\n\tif (ctx.emitters[type][index].alive === false) return;\n\tctx.emitters[type][index].timeToLive -= ctx.world.tpf;\n\tif (ctx.emitters[type][index].timeToLive < 0) {\n\t\tremoveEmitter(ctx, type, index);\n\t} else {\n\t\tctx.emitters[type][index].entities.forEach(function(v) {\n\t\t\tvar velocity = v.getAttribute('velocity');\n\t\t\tvelocity.y += ctx.acceleration[type]*ctx.world.tpf;\n\t\t\tv.addTranslation(velocity.x*ctx.world.tpf, velocity.y*ctx.world.tpf, velocity.z*ctx.world.tpf);\n\t\t});\n\t}\n};\n\nvar updateAllEmitters = function(ctx) {\n\tctx.emitters.forEach(function(type, typeIndex) {\n\t\ttype.forEach(function(emitter, emitterIndex) {\n\t\t\tupdateEmitter(ctx, typeIndex, emitterIndex);\n\t\t});\n\t});\n};\n\nvar removeEmitter = function(ctx, type, index) {\n\tvar impactEntities = ctx.emitters[type][index].entities;\n\timpactEntities.forEach(function(v) {\n\t\tv.removeFromWorld();\n\t});\n\tctx.emitters[type][index].alive = false;\n};\n\nvar removeAllEmitters = function(ctx) {\n\tctx.emitters.forEach(function(type, typeIndex) {\n\t\ttype.forEach(function(emitter, emitterIndex) {\n\t\t\tremoveEmitter(ctx, typeIndex, emitterIndex);\n\t\t});\n\t});\n};\n\nvar drawLine = function(ctx, v0, v1) {\n\n\tctx.lineMaterial = new g.Material(goo.ShaderLib.uber);\n\tctx.lineMaterial.uniforms.materialDiffuse = [0, 0, 0, 0];\n\tctx.lineMaterial.uniforms.materialEmissive = [0, 1, 0, 1];\n\tctx.lineMaterial.blendState.blending = 'CustomBlending';\n    ctx.lineMaterial.cullState.enabled = false;\n\t\n\tif (!pl) return;\n\tvar polyLine = new pl([v0.x, v0.y, v0.z, v1.x, v1.y, v1.z]);\n\tctx.lines.push({\n\t\tttl: ctx.ttl,\n\t\tentity: ctx.world.createEntity(polyLine, ctx.lineMaterial).addToWorld()\n\t});\n};\n\nvar update = function(args, ctx, goo) {\n\tupdateAllEmitters(ctx);\n\tvar i = ctx.lines.length;\n\twhile (i--) {\n\t\tctx.lines[i].ttl -= ctx.world.tpf;\n\t\tctx.lines[i].entity.meshRendererComponent.materials[0].uniforms.opacity = ctx.lines[i].ttl / ctx.ttl;\n\t\tif (ctx.lines[i].ttl < 0) {\n\t\t\tctx.lines[i].entity.removeFromWorld();\n\t\t\tctx.lines.splice(i, 1);\n\t\t}\n\t}\n};\n\nvar parameters = [\n{\n\tkey: 'numImpacts',\n\tname: '# Impacts',\n\ttype: 'int',\n\tdefault: 10\n},\n{\n\tkey: 'numEntities',\n\tname: '# Entities',\n\ttype: 'int',\n\tdefault: 5\n},\n{\n\tkey: 'lifeTime',\n\tname: 'Life Time',\n\ttype: 'float',\n\tdefault: 1.0\n}\n];","name":"Effects","license":"CC0","created":"2014-12-09T10:18:23.712364+00:00","deleted":false,"modified":"2014-12-09T10:18:23.712393+00:00","dataModelVersion":2,"dependencies":{"https://code.gooengine.com/latest/lib/geometrypack.js":{"url":"https://code.gooengine.com/latest/lib/geometrypack.js","sortValue":0}},"id":"c6ff4413cc27419ba272d3ce5c1fc07f.script"},"46daab6dafd543dba7d9acf5e1741e7c.entity":{"name":"X+ Wall","license":"CC0","tags":{},"deleted":false,"created":"2014-12-09T10:18:24.332557+00:00","dataModelVersion":2,"modified":"2014-12-09T10:18:24.332582+00:00","static":false,"components":{"transform":{"translation":[50,0,0],"scale":[100,10,1],"rotation":[0,-90,0]},"meshRenderer":{"receiveShadows":true,"materials":{"8021ee4cb6f74e7c8a023d7d8ec9b231.material":{"materialRef":"8021ee4cb6f74e7c8a023d7d8ec9b231.material","sortValue":0}},"reflectable":true,"cullMode":"Dynamic","castShadows":true},"meshData":{"shape":"Quad"}},"hidden":false,"id":"46daab6dafd543dba7d9acf5e1741e7c.entity"},"bf84dfe1c17a4d949157649a3b0bb55e.material":{"texturesMapping":{"DIFFUSE_MAP":{"enabled":true,"textureRef":"3213bc5745454190b3cab9ee15d88e3b.texture"}},"flat":false,"cullState":{"frontFace":"CCW","enabled":true,"cullFace":"Back"},"uniforms":{"opacity":{"enabled":false,"value":1},"refractivity":{"enabled":false,"value":0},"materialAmbient":{"enabled":true,"value":[1,1,1,1]},"materialSpecular":{"enabled":true,"value":[0,0,0,1]},"fresnel":{"enabled":true,"value":0},"vertexColorAmount":{"enabled":true,"value":1},"materialSpecularPower":{"enabled":true,"value":64},"materialDiffuse":{"enabled":true,"value":[0.8,0.8,0.8,1]},"reflectivity":{"enabled":true,"value":0},"materialEmissive":{"enabled":true,"value":[0,0,0,1]},"discardThreshold":{"enabled":true,"value":0.1},"normalMultiplier":{"enabled":true,"value":1},"etaRatio":{"enabled":true,"value":-0.5},"reflectionType":0,"wrapSettings":{"enabled":true,"value":[0,0]}},"name":"Material 3","license":"CC0","created":"2014-12-09T10:18:24.630605+00:00","deleted":false,"wireframe":false,"dataModelVersion":2,"blendState":{"blendEquation":"AddEquation","blendSrc":"SrcAlphaFactor","blendDst":"OneMinusSrcAlphaFactor","blending":"NoBlending"},"modified":"2014-12-09T10:18:24.630636+00:00","dualTransparency":false,"depthState":{"write":true,"enabled":true},"shaderRef":"GOO_ENGINE_SHADERS/uber","id":"bf84dfe1c17a4d949157649a3b0bb55e.material","renderQueue":-1},"4d179364f676469ab50fe08e6fd2e9b9.texture":{"wrapS":"Repeat","minFilter":"Trilinear","name":"jcxEeeKcE.png","license":"CC0","flipY":true,"deleted":false,"magFilter":"Bilinear","created":"2014-12-09T10:18:23.079082+00:00","dataModelVersion":2,"modified":"2014-12-09T10:18:23.079105+00:00","repeat":[1,1],"imageRef":"0f98e66ecb6742d01a942b3e7cc2a6fe7a651f1d.png","anisotropy":1,"offset":[0,0],"generateMipmaps":true,"id":"4d179364f676469ab50fe08e6fd2e9b9.texture","wrapT":"Repeat"},"2dd7b84e79df492385b93e9c04926a0f.machine":{"name":"Behavior","license":"CC0","created":"2014-12-09T10:18:26.199497+00:00","deleted":false,"modified":"2014-12-09T10:18:26.199519+00:00","dataModelVersion":2,"states":{"2f1a7ac62d02423a927eeba792331176.state":{"actions":{"5fcb5ac0005246ec92401d9c9993a1e7.action":{"options":{"sound":"48ebfdbbb38944518ce1c90a68941be9.sound","transitions":{"complete":"a4fa63c11671411ab2e9635e39ecab34.transition"},"time":"1"},"type":"Sound Fade In","id":"5fcb5ac0005246ec92401d9c9993a1e7.action","sortValue":0,"name":"Sound Fade In"}},"transitions":{"a4fa63c11671411ab2e9635e39ecab34.transition":{"targetState":"583c610f8d4c40f0bb51e01892010859.state","id":"a4fa63c11671411ab2e9635e39ecab34.transition","sortValue":0,"name":"On Completion"}},"id":"2f1a7ac62d02423a927eeba792331176.state","sortValue":3,"name":"play_enemy_hit"},"c263460229e64e71bd65a305002896ee.state":{"id":"c263460229e64e71bd65a305002896ee.state","transitions":{"fc9bc300cc71404fac388b7ff0398da1.transition":{"name":"On Completion","targetState":"583c610f8d4c40f0bb51e01892010859.state","sortValue":0,"id":"fc9bc300cc71404fac388b7ff0398da1.transition"}},"name":"play_spawn","actions":{"f998e71a74124ae699e894009f333566.action":{"name":"Sound Fade In","type":"Sound Fade In","options":{"sound":"e5427b9b2a1249838fd4f25aa3c61125.sound","transitions":{"complete":"fc9bc300cc71404fac388b7ff0398da1.transition"},"time":"1"},"sortValue":0,"id":"f998e71a74124ae699e894009f333566.action"}},"sortValue":4},"1e6b664870314086aeff77f15179cae6.state":{"id":"1e6b664870314086aeff77f15179cae6.state","transitions":{"97142d1d56c14595ac882059bea23d72.transition":{"name":"On Completion","targetState":"583c610f8d4c40f0bb51e01892010859.state","sortValue":0,"id":"97142d1d56c14595ac882059bea23d72.transition"}},"name":"play_pain","actions":{"194152ab1cc344358268df07f7514f82.action":{"name":"Sound Fade In","type":"Sound Fade In","options":{"sound":"d673646b2a114245b02e9062c9d95c53.sound","transitions":{"complete":"97142d1d56c14595ac882059bea23d72.transition"},"time":"1"},"sortValue":0,"id":"194152ab1cc344358268df07f7514f82.action"}},"sortValue":2},"583c610f8d4c40f0bb51e01892010859.state":{"sortValue":0,"transitions":{"a059f7b8720a4c21a941f99e5806b7c0.transition":{"id":"a059f7b8720a4c21a941f99e5806b7c0.transition","name":"To","sortValue":0,"targetState":"c8ae968e54d34235a10e1779d0bb5e75.state"},"e8ae6440a478450bacca864855ec7666.transition":{"name":"To","targetState":"1e6b664870314086aeff77f15179cae6.state","sortValue":1,"id":"e8ae6440a478450bacca864855ec7666.transition"},"38d4fa8dbb6d41af9cfb33c62bfc5b03.transition":{"targetState":"2f1a7ac62d02423a927eeba792331176.state","id":"38d4fa8dbb6d41af9cfb33c62bfc5b03.transition","sortValue":2,"name":"To"},"ba5a922905d14a059f8f64af40d1048e.transition":{"name":"To","targetState":"c263460229e64e71bd65a305002896ee.state","sortValue":3,"id":"ba5a922905d14a059f8f64af40d1048e.transition"}},"name":"idle","actions":{"31057cfd6975434ab3c9ecfc1020609e.action":{"name":"Listen","type":"Transition on Message","options":{"transitions":{"transition":"ba5a922905d14a059f8f64af40d1048e.transition"},"channel":"spawn"},"sortValue":3,"id":"31057cfd6975434ab3c9ecfc1020609e.action"},"a4f7fa1dd9aa43328024ae1363987e17.action":{"id":"a4f7fa1dd9aa43328024ae1363987e17.action","type":"Transition on Message","name":"Listen","sortValue":0,"options":{"transitions":{"transition":"a059f7b8720a4c21a941f99e5806b7c0.transition"},"channel":"fire"}},"648e6d0e4c064d3c8ecb1067cf813ad4.action":{"name":"Listen","type":"Transition on Message","options":{"transitions":{"transition":"e8ae6440a478450bacca864855ec7666.transition"},"channel":"i_am_hit"},"sortValue":1,"id":"648e6d0e4c064d3c8ecb1067cf813ad4.action"},"bd9984d215594b509b6a492f32af20a4.action":{"options":{"transitions":{"transition":"38d4fa8dbb6d41af9cfb33c62bfc5b03.transition"},"channel":"hit_target"},"type":"Transition on Message","id":"bd9984d215594b509b6a492f32af20a4.action","sortValue":2,"name":"Listen"}},"id":"583c610f8d4c40f0bb51e01892010859.state"},"c8ae968e54d34235a10e1779d0bb5e75.state":{"sortValue":1,"transitions":{"879c4611cffe4aee8086a2547847aba8.transition":{"id":"879c4611cffe4aee8086a2547847aba8.transition","name":"On Completion","sortValue":0,"targetState":"583c610f8d4c40f0bb51e01892010859.state"}},"name":"play_fire","actions":{"59dd9f53fa154f4b83c0196ad8063417.action":{"id":"59dd9f53fa154f4b83c0196ad8063417.action","type":"Sound Fade In","name":"Sound Fade In","sortValue":0,"options":{"sound":"d751ea7b0cfd4a5ea99453d0b0efa1f0.sound","transitions":{"complete":"879c4611cffe4aee8086a2547847aba8.transition"},"time":"1"}}},"id":"c8ae968e54d34235a10e1779d0bb5e75.state"}},"initialState":"583c610f8d4c40f0bb51e01892010859.state","id":"2dd7b84e79df492385b93e9c04926a0f.machine"},"9f0a88bf374c4842bc6cdaeed0cf0164.entity":{"name":"Sounds 2","license":"CC0","tags":{},"deleted":false,"created":"2014-12-09T10:18:24.093618+00:00","dataModelVersion":2,"modified":"2014-12-09T10:18:24.093643+00:00","static":false,"components":{"sound":{"volume":1,"sounds":{"d10e0e1b76544af4a1d7ffbf0f93f7b5.sound":{"soundRef":"d10e0e1b76544af4a1d7ffbf0f93f7b5.sound","sortValue":5}}},"transform":{"translation":[0,0,0],"scale":[1,1,1],"rotation":[0,0,0]},"stateMachine":{"machines":{"77d6091104464320884290009c32be04.machine":{"machineRef":"77d6091104464320884290009c32be04.machine","sortValue":0}}}},"hidden":false,"id":"9f0a88bf374c4842bc6cdaeed0cf0164.entity"},"703fbe0d998840b29802c00691f9da91.entity":{"name":"Player","license":"CC0","tags":{},"deleted":false,"created":"2014-12-09T10:18:25.531472+00:00","modified":"2014-12-09T10:18:25.531493+00:00","dataModelVersion":2,"static":false,"components":{"transform":{"translation":[0,0,0],"scale":[1,1,1],"rotation":[0,0,0],"children":{"0c78d2a43d934df2a44265674f2edfed.entity":{"entityRef":"0c78d2a43d934df2a44265674f2edfed.entity","sortValue":1},"8d75e94c49b74ca4bfd7268ff3fb09ab.entity":{"entityRef":"8d75e94c49b74ca4bfd7268ff3fb09ab.entity","sortValue":2}}},"meshData":{"shape":"Box","shapeOptions":{"textureMode":"Uniform"}}},"hidden":false,"id":"703fbe0d998840b29802c00691f9da91.entity"},"d10e0e1b76544af4a1d7ffbf0f93f7b5.sound":{"name":"die","license":"CC0","created":"2014-12-09T10:18:22.939350+00:00","deleted":false,"audioRefs":{"mp3":"2a11da17656ff34d17dcb80a224f106642750451.mp3"},"dataModelVersion":2,"modified":"2014-12-09T10:18:22.939374+00:00","volume":1,"id":"d10e0e1b76544af4a1d7ffbf0f93f7b5.sound","loop":false},"6eec7c3a472a43579715267106ef35ea.sound":{"name":"die","license":"CC0","created":"2014-12-09T10:18:25.675484+00:00","deleted":false,"audioRefs":{"mp3":"2a11da17656ff34d17dcb80a224f106642750451.mp3"},"dataModelVersion":2,"modified":"2014-12-09T10:18:25.675509+00:00","volume":1,"id":"6eec7c3a472a43579715267106ef35ea.sound","loop":false},"9ad11ee10edc40568562d5b68e540cd8.machine":{"name":"Behavior","license":"CC0","created":"2014-12-09T10:18:24.822664+00:00","deleted":false,"modified":"2014-12-09T10:18:24.822696+00:00","dataModelVersion":2,"states":{"b7067fb2fbf5499fa5cc1f405ad5f7c4.state":{"id":"b7067fb2fbf5499fa5cc1f405ad5f7c4.state","transitions":{"8f0e337a6f544b77ba3dc0db591be950.transition":{"name":"To","targetState":"dd0580bcbf52453e8aae1cc45bee5d66.state","sortValue":0,"id":"8f0e337a6f544b77ba3dc0db591be950.transition"}},"name":"Playing","actions":{"ade6f6ffa88f42f69cc51e0d31b65bb8.action":{"name":"Listen","type":"Transition on Message","options":{"transitions":{"transition":"8f0e337a6f544b77ba3dc0db591be950.transition"},"channel":"i_am_dead"},"sortValue":1,"id":"ade6f6ffa88f42f69cc51e0d31b65bb8.action"},"5b4e1db3033d4a1e9284a9de736e844a.action":{"name":"Switch Camera","type":"Switch Camera","options":{"cameraEntityRef":"0c78d2a43d934df2a44265674f2edfed.entity","transitions":{}},"sortValue":0,"id":"5b4e1db3033d4a1e9284a9de736e844a.action"}},"sortValue":0},"dd0580bcbf52453e8aae1cc45bee5d66.state":{"id":"dd0580bcbf52453e8aae1cc45bee5d66.state","transitions":{"f6a09eb16d524b3388fe559f6120eb21.transition":{"name":"To","targetState":"b7067fb2fbf5499fa5cc1f405ad5f7c4.state","sortValue":0,"id":"f6a09eb16d524b3388fe559f6120eb21.transition"}},"name":"Hovering","actions":{"079d46c8be7c4c699266743c340c2ae8.action":{"name":"Listen","type":"Transition on Message","options":{"transitions":{"transition":"f6a09eb16d524b3388fe559f6120eb21.transition"},"channel":"i_spawned"},"sortValue":1,"id":"079d46c8be7c4c699266743c340c2ae8.action"},"a1aaeb95f41f4216a1dd3afad71c2127.action":{"name":"Switch Camera","type":"Switch Camera","options":{"cameraEntityRef":"27f89a3380c44a9a94a1f7894b9a5805.entity","transitions":{}},"sortValue":0,"id":"a1aaeb95f41f4216a1dd3afad71c2127.action"}},"sortValue":1}},"initialState":"dd0580bcbf52453e8aae1cc45bee5d66.state","id":"9ad11ee10edc40568562d5b68e540cd8.machine"},"87303e39ea224183946cf3bcac950b62.texture":{"wrapS":"Repeat","minFilter":"Trilinear","name":"tile.jpg 3","license":"CC0","flipY":true,"deleted":false,"magFilter":"Bilinear","created":"2014-12-09T10:18:23.903300+00:00","dataModelVersion":2,"modified":"2014-12-09T10:18:23.903325+00:00","repeat":[64,32],"imageRef":"91697bfea1d925a47713ee559251613925e98585.jpg","lodBias":0,"offset":[0,0],"generateMipmaps":true,"wrapT":"Repeat","id":"87303e39ea224183946cf3bcac950b62.texture","anisotropy":1},"a2d72c434089483abc8289b98f71b8b1.entity":{"name":"Status Panel","license":"CC0","tags":{},"deleted":false,"created":"2014-12-09T10:18:23.948442+00:00","dataModelVersion":2,"modified":"2014-12-09T10:18:23.948466+00:00","static":false,"components":{"html":{"imageRefs":{},"useTransformComponent":false,"innerHtml":"<style>\n\n\t#status {\n\t\tposition: absolute;\n\t\ttext-align: center;\n\t\twidth: 1000px;\n\t\tcolor: white;\n\t\tfont-family: 'Trebuchet MS';\n\t\tfont-size: 40px;\n\t}\n\t\n\t#status-minor {\n\t\tdisplay: block;\n\t\tmargin: 0 auto;\n\t\tmargin-top: 0px;\n\t\tfont-size: 20px;\n\t}\n\t\n\t#status-major {\n\t\tdisplay: block;\n\t\tmargin: 0 auto;\n\t}\n\t\n</style>\n\n<div id=\"status\">\n\t<span id=\"status-major\">Major</span><br />\n\t<span id=\"status-minor\">Minor</span>\n</div>\n\n\n\n"},"transform":{"translation":[0,-23.054624557495117,37.505035400390625],"scale":[1,1,1],"rotation":[0,0,0]}},"hidden":false,"id":"a2d72c434089483abc8289b98f71b8b1.entity"},"98209e731f184ccfb3eba1ae86a117a6.texture":{"wrapS":"Repeat","minFilter":"BilinearNoMipMaps","imageRef":"82d74d02af75cdcf460564f0edd3db1db0a4b6bd.jpg","license":"CC0","flipY":false,"deleted":false,"name":"texture_44","magFilter":"Bilinear","created":"2014-12-09T10:18:26.400379+00:00","dataModelVersion":2,"modified":"2014-12-09T10:18:26.400402+00:00","repeat":[0,0],"anisotropy":1,"offset":[0,0],"id":"98209e731f184ccfb3eba1ae86a117a6.texture","generateMipmaps":true,"originalLicense":"CC0","wrapT":"Repeat"},"5f9b57a637664673b655e3981291f6ac.pack":{"name":"Default Pack","license":"CC0","created":"2015-06-09T11:08:28.342338+00:00","deleted":false,"modified":"2015-06-09T11:08:28.342338+00:00","dataModelVersion":2,"objects":{"d673646b2a114245b02e9062c9d95c53.sound":{"objectRef":"d673646b2a114245b02e9062c9d95c53.sound","sortValue":37},"c3ce6b61777c4b838211a26c4551306d.texture":{"objectRef":"c3ce6b61777c4b838211a26c4551306d.texture","sortValue":41},"d2825b5b9ed84d47917e9f010fb125f5.script":{"objectRef":"d2825b5b9ed84d47917e9f010fb125f5.script","sortValue":12},"facdb3e7d90d4fd486739c38c7ac6ac5.script":{"objectRef":"facdb3e7d90d4fd486739c38c7ac6ac5.script","sortValue":19},"1ef1364e04d94c5aa159d81b60cc1c2c.script":{"objectRef":"1ef1364e04d94c5aa159d81b60cc1c2c.script","sortValue":17},"8021ee4cb6f74e7c8a023d7d8ec9b231.material":{"objectRef":"8021ee4cb6f74e7c8a023d7d8ec9b231.material","sortValue":16},"5d3164c6dd084c64937d099f313a97b6.material":{"objectRef":"5d3164c6dd084c64937d099f313a97b6.material","sortValue":15},"bdc6faf75115419286209fa30dd17e0c.script":{"objectRef":"bdc6faf75115419286209fa30dd17e0c.script","sortValue":4},"98209e731f184ccfb3eba1ae86a117a6.texture":{"objectRef":"98209e731f184ccfb3eba1ae86a117a6.texture","sortValue":39},"8ff1e27efc814544ae54fcdf836a3634.texture":{"objectRef":"8ff1e27efc814544ae54fcdf836a3634.texture","sortValue":47},"c7f6aa5a444b41acae22b7f8ee649c08.texture":{"objectRef":"c7f6aa5a444b41acae22b7f8ee649c08.texture","sortValue":43},"b1fc00b31bf1439ab2d1bfe36fda1757.script":{"objectRef":"b1fc00b31bf1439ab2d1bfe36fda1757.script","sortValue":23},"bf84dfe1c17a4d949157649a3b0bb55e.material":{"objectRef":"bf84dfe1c17a4d949157649a3b0bb55e.material","sortValue":14},"4fcbdd6b85f6402bb0dc79ed7cd31408.texture":{"objectRef":"4fcbdd6b85f6402bb0dc79ed7cd31408.texture","sortValue":44},"15fbb7eae6814695a34bf8fd10415400.script":{"objectRef":"15fbb7eae6814695a34bf8fd10415400.script","sortValue":20},"7c641ba033da44dcb00840da16155ff0.script":{"objectRef":"7c641ba033da44dcb00840da16155ff0.script","sortValue":11},"2dd7b84e79df492385b93e9c04926a0f.machine":{"objectRef":"2dd7b84e79df492385b93e9c04926a0f.machine","sortValue":1},"3213bc5745454190b3cab9ee15d88e3b.texture":{"objectRef":"3213bc5745454190b3cab9ee15d88e3b.texture","sortValue":45},"5069d7230bf948f2bce8aebc0af137cd.script":{"objectRef":"5069d7230bf948f2bce8aebc0af137cd.script","sortValue":10},"48ebfdbbb38944518ce1c90a68941be9.sound":{"objectRef":"48ebfdbbb38944518ce1c90a68941be9.sound","sortValue":30},"4092bd2065d646e88e394090829e14d4.skybox":{"objectRef":"4092bd2065d646e88e394090829e14d4.skybox","sortValue":8},"a3554adfce12433ca673b875aeca56a8.script":{"objectRef":"a3554adfce12433ca673b875aeca56a8.script","sortValue":5},"af91f807ff3b43f4b51d0099d1dc3190.script":{"objectRef":"af91f807ff3b43f4b51d0099d1dc3190.script","sortValue":18},"d751ea7b0cfd4a5ea99453d0b0efa1f0.sound":{"objectRef":"d751ea7b0cfd4a5ea99453d0b0efa1f0.sound","sortValue":36},"39fef29a8296450ebb61ce4c5bd80d34.sound":{"objectRef":"39fef29a8296450ebb61ce4c5bd80d34.sound","sortValue":7},"c285b989b9d84501a8c7493adfae9fc5.script":{"objectRef":"c285b989b9d84501a8c7493adfae9fc5.script","sortValue":24},"8c304342c23f4e789e9020bc2d3c9279.sound":{"objectRef":"8c304342c23f4e789e9020bc2d3c9279.sound","sortValue":34},"2bd7484651344980865f953b941b9264.texture":{"objectRef":"2bd7484651344980865f953b941b9264.texture","sortValue":40},"e455f1c251b84d53bb804ce0a675fa3e.sound":{"objectRef":"e455f1c251b84d53bb804ce0a675fa3e.sound","sortValue":35},"cc72a19fb13b4b029636ca89efae4403.material":{"objectRef":"cc72a19fb13b4b029636ca89efae4403.material","sortValue":32},"7f5310e3c80b4deeb4e9f622d174558c.sound":{"objectRef":"7f5310e3c80b4deeb4e9f622d174558c.sound","sortValue":27},"c6ff4413cc27419ba272d3ce5c1fc07f.script":{"objectRef":"c6ff4413cc27419ba272d3ce5c1fc07f.script","sortValue":9},"9ad11ee10edc40568562d5b68e540cd8.machine":{"objectRef":"9ad11ee10edc40568562d5b68e540cd8.machine","sortValue":2},"4d179364f676469ab50fe08e6fd2e9b9.texture":{"objectRef":"4d179364f676469ab50fe08e6fd2e9b9.texture","sortValue":31},"c97bcb54014b4f76b48fc50e6adf33ae.script":{"objectRef":"c97bcb54014b4f76b48fc50e6adf33ae.script","sortValue":26},"68be5d7202654290b97aa79b097bfb65.texture":{"objectRef":"68be5d7202654290b97aa79b097bfb65.texture","sortValue":42},"d10e0e1b76544af4a1d7ffbf0f93f7b5.sound":{"objectRef":"d10e0e1b76544af4a1d7ffbf0f93f7b5.sound","sortValue":28},"6eec7c3a472a43579715267106ef35ea.sound":{"objectRef":"6eec7c3a472a43579715267106ef35ea.sound","sortValue":29},"87303e39ea224183946cf3bcac950b62.texture":{"objectRef":"87303e39ea224183946cf3bcac950b62.texture","sortValue":46},"c000042ac5a94fd695acce743602bbf7.script":{"objectRef":"c000042ac5a94fd695acce743602bbf7.script","sortValue":25},"6475233573624485941e03c345b05f9a.sound":{"objectRef":"6475233573624485941e03c345b05f9a.sound","sortValue":33},"dc01ec6a2d0d4bdfb47d3671125c06bd.environment":{"objectRef":"dc01ec6a2d0d4bdfb47d3671125c06bd.environment","sortValue":6},"b9dd9c018759437bb668b123341a3a16.material":{"objectRef":"b9dd9c018759437bb668b123341a3a16.material","sortValue":13},"64dd795705e44c63802029c51c083436.posteffects":{"objectRef":"64dd795705e44c63802029c51c083436.posteffects","sortValue":22},"77d6091104464320884290009c32be04.machine":{"objectRef":"77d6091104464320884290009c32be04.machine","sortValue":3},"a443f2ef9ca74b68bcd7db81ab1e118f.script":{"objectRef":"a443f2ef9ca74b68bcd7db81ab1e118f.script","sortValue":21},"c69bb6c6ab88402893cfcfb395011452.machine":{"objectRef":"c69bb6c6ab88402893cfcfb395011452.machine","sortValue":0},"e5427b9b2a1249838fd4f25aa3c61125.sound":{"objectRef":"e5427b9b2a1249838fd4f25aa3c61125.sound","sortValue":38}},"id":"5f9b57a637664673b655e3981291f6ac.pack"},"dc01ec6a2d0d4bdfb47d3671125c06bd.environment":{"sound":{"volume":1,"dopplerFactor":0,"reverb":0,"rolloffFactor":0.4,"maxDistance":100},"globalAmbient":[0.08802083333333333,0.08545355902777776,0.08545355902777776,0],"license":"CC0","created":"2014-12-09T10:18:25.096567+00:00","deleted":false,"dataModelVersion":2,"modified":"2014-12-09T10:18:25.096590+00:00","weather":{"snow":{"velocity":10,"rate":10,"enabled":false,"height":25}},"fog":{"color":[1,0,0],"far":74,"near":0,"enabled":false},"backgroundColor":[0.3,0.3,0.3,1],"skyboxRef":"4092bd2065d646e88e394090829e14d4.skybox","id":"dc01ec6a2d0d4bdfb47d3671125c06bd.environment","name":"Default Environment"},"b9dd9c018759437bb668b123341a3a16.material":{"texturesMapping":{"DIFFUSE_MAP":{"enabled":true,"textureRef":"87303e39ea224183946cf3bcac950b62.texture"}},"flat":false,"cullState":{"frontFace":"CCW","enabled":true,"cullFace":"Back"},"uniforms":{"opacity":{"enabled":false,"value":1},"refractivity":{"enabled":false,"value":0},"materialAmbient":{"enabled":true,"value":[1,1,1,1]},"materialSpecular":{"enabled":true,"value":[0,0,0,1]},"fresnel":{"enabled":true,"value":0},"vertexColorAmount":{"enabled":true,"value":1},"materialSpecularPower":{"enabled":true,"value":64},"materialDiffuse":{"enabled":true,"value":[0.8,0.8,0.8,1]},"reflectivity":{"enabled":true,"value":0},"materialEmissive":{"enabled":true,"value":[0,0,0,1]},"discardThreshold":{"enabled":true,"value":0.1},"normalMultiplier":{"enabled":true,"value":1},"etaRatio":{"enabled":true,"value":-0.5},"reflectionType":0,"wrapSettings":{"enabled":true,"value":[0,0]}},"name":"Material 2","license":"CC0","created":"2014-12-09T10:18:21.725854+00:00","deleted":false,"wireframe":false,"dataModelVersion":2,"blendState":{"blendEquation":"AddEquation","blendSrc":"SrcAlphaFactor","blendDst":"OneMinusSrcAlphaFactor","blending":"NoBlending"},"modified":"2014-12-09T10:18:21.725877+00:00","dualTransparency":false,"depthState":{"write":true,"enabled":true},"shaderRef":"GOO_ENGINE_SHADERS/uber","id":"b9dd9c018759437bb668b123341a3a16.material","renderQueue":-1},"a0960f37dd19450285607dbff446ffc4.entity":{"name":"Name Prompt","license":"CC0","created":"2014-12-09T10:18:23.320450+00:00","deleted":false,"modified":"2014-12-09T10:18:23.320476+00:00","dataModelVersion":2,"static":false,"components":{"html":{"imageRefs":{},"useTransformComponent":false,"innerHtml":"<style>\n\t#name-input-wrapper {\n\t\tposition: relative;\n\t\twidth: 1000px;\n\t\ttop: 150px;\n\t\tdisplay: none;\n\t}\n\t\n\t#name-input {\n\t\tposition: relative;\n\t\tdisplay: block;\n\t\twidth: 400px;\n\t\theight: 50px;\n\t\tmargin: 0 auto;\n\t\tfont-size: 30px;\n\t\tfont-family: 'Trebuchet MS';\n\t}\n</style>\n\n<div id='name-input-wrapper'>\n\t<input id='name-input' value='?????'></input>\n</div>\n"},"transform":{"translation":[0,0,0],"scale":[1,1,1],"rotation":[0,0,0]}},"hidden":false,"id":"a0960f37dd19450285607dbff446ffc4.entity"},"db0ac50aa42e4daaa7e6def88da5d421.entity":{"name":"Light","license":"CC0","tags":{},"deleted":false,"created":"2014-12-09T10:18:21.265617+00:00","dataModelVersion":2,"modified":"2014-12-09T10:18:21.265645+00:00","static":false,"components":{"light":{"direction":[0,0,0],"shadowCaster":false,"color":[1,1,1,1],"intensity":5.19,"range":60,"specularIntensity":0.15,"penumbra":32,"angle":51,"type":"SpotLight","shadowSettings":{"fov":51,"darkness":1,"far":60,"near":1,"resolution":[512,512],"shadowType":"PCF","size":100}},"transform":{"translation":[0,0,-1.5],"scale":[1,1,1],"rotation":[-1.95814,0,0]}},"hidden":true,"id":"db0ac50aa42e4daaa7e6def88da5d421.entity"},"64dd795705e44c63802029c51c083436.posteffects":{"name":"Post effects","license":"CC0","created":"2014-12-09T10:18:21.770818+00:00","deleted":false,"dataModelVersion":2,"posteffects":{},"modified":"2014-12-09T10:18:21.770840+00:00","id":"64dd795705e44c63802029c51c083436.posteffects"},"3be4ae77975a4df9bb1b134eef605dda.entity":{"name":"Occluder Master","license":"CC0","tags":{},"deleted":false,"created":"2014-12-09T10:18:21.319392+00:00","dataModelVersion":2,"modified":"2014-12-09T10:18:21.319414+00:00","static":false,"components":{"transform":{"translation":[0,-5,0],"scale":[1,1,1],"rotation":[90,0,0]},"meshRenderer":{"receiveShadows":true,"materials":{"b9dd9c018759437bb668b123341a3a16.material":{"materialRef":"b9dd9c018759437bb668b123341a3a16.material","sortValue":0}},"reflectable":true,"cullMode":"Dynamic","castShadows":true},"meshData":{"shape":"Sphere","shapeOptions":{"zSamples":64,"textureMode":"Projected","radialSamples":64}}},"hidden":false,"id":"3be4ae77975a4df9bb1b134eef605dda.entity"},"a443f2ef9ca74b68bcd7db81ab1e118f.script":{"body":"/*\n\nA rather big (TODO - refactor) script responsible for moving the player.\nIt reacts instantly to input, but uses client prediction mechanisms to \nlet the server be authorative.\n\n1. Move the local player instantly, and send move deltas to server\n2. When the server later responds, set the position to the server's position.\n3. Replay any local movements that happened between 1 and 2\n\nFor this to work, the client needs to replicate the movement and collisions.\nThis is currently re-implemented. \nTODO - share the game core with the server for less code duplication.\n\n*/\n\n\n\nvar g;\nvar setup = function(args, ctx, goo) {\n\tg = goo;\n\t\n\tctx.entity = ctx.world.by.name('Player').first();\n\tctx.crosshair = ctx.world.by.name('Crosshair').first();\n\t\n\tctx.worldData.alive = false;\n\t\n\t// Client sends its own deltas, the server validates speed limits (eventually)\n\tctx.deltaQueue = [];\n\tctx.deltaSeq = 0;\n\n\tctx.onInit = function() {\n\t\tctx.worldData.displayHealth(1);\n\t\t// We need to modify the server core a little bit (make Goo vectors)\n\t\tctx.worldData.constants.forward = new g.Vector3(\n\t\t\tctx.worldData.constants.forward.x,\n\t\t\tctx.worldData.constants.forward.y,\n\t\t\tctx.worldData.constants.forward.z);\n\t\tctx.worldData.constants.left = new g.Vector3(\n\t\t\tctx.worldData.constants.left.x,\n\t\t\tctx.worldData.constants.left.y,\n\t\t\tctx.worldData.constants.left.z);\n\t\t// For brevity\n\t\tctx.w = ctx.worldData.constants.walls;\n\t\tctx.r = ctx.worldData.constants.hitRadius;\n\t};\n\tg.SystemBus.addListener('server_init', ctx.onInit);\n\t\n\t// Init prediction player\n\tctx.playerSpawned = function(player) {\n\t\tif (player.id == ctx.worldData.id) {\n\t\t\tctx.worldData.predictPlayer = cloneEssentials(player);\n\t\t\tctx.worldData.alive = true;\n\t\t\tctx.worldData.showStatus('Go!', '', 1);\n\t\t\tg.SystemBus.emit('spawn');\n\t\t\tg.SystemBus.emit('spawn_self');\n\t\t\tg.SystemBus.emit('hide_scores');\n\t\t}\n\t};\n\tg.SystemBus.addListener('player_spawned', ctx.playerSpawned);\n\t\n\t// When the server has handled deltas, remove them from local queue\n\tctx.handledDeltas = function() {\n\t\tremoveHandledDeltasFromQueue(ctx);\n\t};\n\tg.SystemBus.addListener('handled_deltas', ctx.handledDeltas);\n\t\n\t// Send firing message to the server instantly\n\t// TODO this could probably be its own script\n\tctx.fire = function() {\n\t\tif (ctx.worldData.alive !== true) return;\n\t\tsetLocalAim(ctx, ctx.worldData.predictPlayer);\n\t\tctx.worldData.pushMessage('c_fire', {\n\t\t\tsource: [ctx.worldData.predictPlayer.position.x,\n\t\t\t\t\tctx.worldData.predictPlayer.position.y+0.5,\n\t\t\t\t\tctx.worldData.predictPlayer.position.z],\n\t\t\tdirection: [ctx.worldData.predictPlayer.localAim.x,\n\t\t\t\t\tctx.worldData.predictPlayer.localAim.y,\n\t\t\t\t\tctx.worldData.predictPlayer.localAim.z]\n\t\t});\n\t};\n\tg.SystemBus.addListener('fire', ctx.fire);\n\t\n\t// React to own death\n\t// TODO maybe move hit/kill reaction to their own script(s)\n\tctx.playerKilled = function(data) {\n\t\tif (data.victim == ctx.worldData.id) {\n\t\t\tctx.worldData.alive = false;\n\t\t\tctx.worldData.showStatus('You got killed by ' + \n\t\t\t\tctx.worldData.playersNew[data.shooter].name, 'Waiting to respawn');\n\t\t\tg.SystemBus.emit('i_am_dead');\n\t\t\tg.SystemBus.emit('show_scores');\n\t\t\tctx.deltaQueue = [];\n\t\t\tctx.worldData.keyState.fwd = false;\n\t\t\tctx.worldData.keyState.bwd = false;\n\t\t\tctx.worldData.keyState.left = false;\n\t\t\tctx.worldData.keyState.right = false;\n\t\t}\n\t};\n\tg.SystemBus.addListener('player_killed', ctx.playerKilled);\n\t\n\tctx.hitSelf = function() {\n\t\tvar h = ctx.worldData.playersNew[ctx.worldData.id].health / ctx.worldData.constants.startHealth;\n\t\tctx.worldData.displayHealth(h);\n\t};\n\tg.SystemBus.addListener('i_am_hit', ctx.hitSelf);\n\t\n\t\n};\n\n// Clone the essentials needed for prediction\nvar cloneEssentials = function(p) {\n\treturn {\n\t\tid: p.id,\n\t\tlocalMove: new g.Vector3(0, 0, 0),\n\t\tlocalAim: new g.Vector3(0, 0, -1),\n\t\tlocalLeft: new g.Vector3(-1, 0, 0),\n\t\tposition: new g.Vector3(p.position.x, p.position.y, p.position.z),\n\t\trotation: p.rotation.slice()\n\t};\n};\n\nvar cleanup = function(args, ctx, goo) {\n\tg.SystemBus.removeListener('player_spawned', ctx.playerSpawned);\n\tg.SystemBus.removeListener('player_killed', ctx.playerKilled);\n\tg.SystemBus.removeListener('fire', ctx.fire);\n\tg.SystemBus.removeListener('handled_deltas', ctx.handledDeltas);\n\tg.SystemBus.removeListener('i_am_hit', ctx.hitSelf);\n\tg.SystemBus.removeListener('server_init', ctx.onInit);\n};\n\nvar update = function(args, ctx, goo) {\n\tif (!ctx.worldData.predictPlayer) return;\n\tupdatePlayer(ctx, ctx.world.tpf);\n};\n\nvar updatePlayer = function(ctx, tpf) {\n\t\n\t// For brevity\n\tctx.p = ctx.worldData.predictPlayer;\n\t\n\tif (ctx.worldData.alive !== true) return;\n\t\n\t// Update state\n\tctx.p.rotation[0] = ctx.worldData.mouse[1]*ctx.worldData.constants.turnSpeed;\n\tctx.p.rotation[1] = ctx.worldData.mouse[0]*ctx.worldData.constants.turnSpeed;\n\tsetLocalMove(ctx, tpf);\n\tsetLocalLeft(ctx, tpf);\n\tctx.prevPos = ctx.p.position.clone();\n\n\tif (ctx.worldData.keyState.fwd === true) ctx.p.position.add(ctx.p.localMove);\n\tif (ctx.worldData.keyState.bwd === true) ctx.p.position.sub(ctx.p.localMove);\n\tif (ctx.worldData.keyState.left === true) ctx.p.position.add(ctx.p.localLeft);\t\n\tif (ctx.worldData.keyState.right === true) ctx.p.position.sub(ctx.p.localLeft);\t\n\t\n\tctx.deltaPos = g.Vector3.sub(ctx.p.position, ctx.prevPos);\n\n\t// Simple wall check\n\tif (ctx.p.position.x+ctx.r > ctx.w || ctx.p.position.x-ctx.r < -ctx.w) {\n\t\tctx.p.position.x -= ctx.deltaPos.x;\n\t}\n\tif (ctx.p.position.z+ctx.r > ctx.w || ctx.p.position.z-ctx.r < -ctx.w) {\n\t\tctx.p.position.z -= ctx.deltaPos.z;\n\t}\n\t\n\t// Simple player check\n\tObject.keys(ctx.worldData.playersNew).forEach(function(v) {\n\t\tctx.o = new g.Vector3(ctx.worldData.playersNew[v].position.x, \n\t\t\tctx.worldData.playersNew[v].position.y, \n\t\t\tctx.worldData.playersNew[v].position.z);\n\t\tvar d = g.Vector3.sub(ctx.p.position, ctx.o);\n\t\tif (v != ctx.worldData.id && d.length() < ctx.r*2) {\n\t\t\td.normalize();\n\t\t\td.scale(0.2);\n\t\t\td.y = 0;\n\t\t\tctx.p.position.add(d);\n\t\t}\n\t});\n\t\n\t// Simple occluder check\n\tctx.worldData.occluders.forEach(function(v) {\n\t\tctx.o = new g.Vector3(v.position.x, v.position.y, v.position.z);\n\t\tvar d = g.Vector3.sub(ctx.p.position, ctx.o);\n\t\tif (d.length() < ctx.r+v.radius) {\n\t\t\td.normalize();\n\t\t\td.scale(0.2);\n\t\t\td.y = 0;\n\t\t\tctx.p.position.add(d);\n\t\t}\n\t});\n\t\n\t// Resync delta atfer collision checks\n\tctx.deltaPos = g.Vector3.sub(ctx.p.position, ctx.prevPos);\n\t\n\t// Set the rotation on the client, server does not care (TODO);\n\tctx.entity.setRotation(ctx.p.rotation[0], ctx.p.rotation[1], 0);\n\t\n\tif (!(ctx.deltaPos.x === 0 && ctx.deltaPos.y === 0 && ctx.deltaPos.z === 0)) {\n\t\t// Push the move to the local queue\n\t\tpushDeltaToQueue(ctx, ctx.deltaPos);\n\t\t// Let the server know we moved\n\t\tctx.worldData.pushMessage('c_delta', [ctx.deltaPos.x, ctx.deltaPos.y, ctx.deltaPos.z]);\n\t}\n\t\n\t// In each frame, always start with the last known position from the server\n\tsetStateFromServer(ctx);\n\t// Then replay the deltas the server hasn't handled yet\n\treplayUnhandledDeltas(ctx);\n\t\n};\n\nvar pushDeltaToQueue = function(ctx, d) {\n\tctx.deltaSeq++;\n\tctx.deltaQueue.push({\n\t\tseq: ctx.deltaSeq,\n\t\tdelta: d\n\t});\n};\n\n\n// Remove all ticks the server has aldready handled from the \n// local input queue, making it ready for replay\nvar removeHandledDeltasFromQueue = function(ctx) {\n\tvar i = ctx.deltaQueue.length;\n\twhile (i--) {\n\t\tif (ctx.deltaQueue[i].seq <= ctx.worldData.handledDeltas) {\n\t\t\tctx.deltaQueue.splice(i, 1);\n\t\t}\n\t}\n};\n\n// Let the server decide the position\nvar setStateFromServer = function(ctx) {\n\tctx.entity.setTranslation(\n\t\tctx.worldData.playersNew[ctx.worldData.id].position.x,\n\t\tctx.worldData.playersNew[ctx.worldData.id].position.y,\n\t\tctx.worldData.playersNew[ctx.worldData.id].position.z\n\t);\n};\n\n// Replay the input state changes that have happened between server updates\n// Note that only translation is replayed, as the server does not\n// care about the rotation (TODO?)\nvar replayUnhandledDeltas = function(ctx) {\n\tctx.deltaQueue.forEach(function(v) {\n\t\tctx.entity.addTranslation(v.delta);\n\t});\n};\n\n\n// Mirror the server movement functions\n// TODO use the server's core to avoid code duplication\n\nvar setLocalMove = function(ctx, tpf) {\n\tctx.p.localMove = ctx.worldData.constants.forward.clone();\n\trotateY(ctx.p.localMove, ctx.p.rotation[1]);\n\tctx.p.localMove.scale(ctx.worldData.constants.moveSpeed*tpf);\n};\n\nvar setLocalLeft = function(ctx, tpf) {\n\tctx.p.localLeft = ctx.worldData.constants.left.clone();\n\trotateY(ctx.p.localLeft, ctx.p.rotation[1]);\n\tctx.p.localLeft.scale(ctx.worldData.constants.moveSpeed*tpf);\n};\n\nvar setLocalAim = function(ctx, p) {\n\tctx.p.localAim = ctx.worldData.constants.forward.clone();\n\trotateX(ctx.p.localAim, ctx.p.rotation[0]);\n\trotateY(ctx.p.localAim, ctx.p.rotation[1]);\n};\n\nvar rotateY = function(v, angle) {\n    var x = v.x;\n    var z = v.z;\n    v.x = x*Math.cos(angle) + z*Math.sin(angle);\n    v.z = -x*Math.sin(angle) + z*Math.cos(angle);\n};\n\n var rotateX = function(v, angle) {\n    var y = v.y;\n    var z = v.z;\n    v.y = y*Math.cos(angle) - z*Math.sin(angle);\n    v.z = y*Math.sin(angle) + z*Math.cos(angle);\n };","name":"Player Move, Prediction, Fire, Death","license":"CC0","created":"2014-12-09T10:18:24.772132+00:00","deleted":false,"modified":"2014-12-09T10:18:24.772155+00:00","dataModelVersion":2,"dependencies":{},"id":"a443f2ef9ca74b68bcd7db81ab1e118f.script"},"e5427b9b2a1249838fd4f25aa3c61125.sound":{"name":"spawn","license":"CC0","created":"2014-12-09T10:18:25.624247+00:00","deleted":false,"audioRefs":{"mp3":"65c2b8a753417bb23f62ba01110f99fb0e2ca840.mp3"},"dataModelVersion":2,"modified":"2014-12-09T10:18:25.624271+00:00","volume":1,"id":"e5427b9b2a1249838fd4f25aa3c61125.sound","loop":false},"5b2f9e08c6ab4fde8007483f8d35800a.entity":{"name":"Crosshair","license":"CC0","tags":{},"deleted":false,"created":"2014-12-09T10:18:23.224315+00:00","modified":"2014-12-09T10:18:23.224336+00:00","dataModelVersion":2,"static":false,"components":{"quad":{"materialRef":"cc72a19fb13b4b029636ca89efae4403.material"},"transform":{"translation":[0,0,-0.11],"scale":[0.00786764919757843,0.00786764919757843,0.00786764919757843],"rotation":[0,0,0]}},"hidden":false,"id":"5b2f9e08c6ab4fde8007483f8d35800a.entity"},"e53ee6df73fd4a6eaf98558e4dbb3c9c.scene":{"canvas":{"resolution":{"width":1920,"height":1080},"mode":"Stretch"},"initialCameraRef":"27f89a3380c44a9a94a1f7894b9a5805.entity","name":"Copy of Goo Arena","license":"CC0","created":"2016-04-29T07:29:20.198808+00:00","deleted":false,"packs":{"5f9b57a637664673b655e3981291f6ac.pack":{"packRef":"5f9b57a637664673b655e3981291f6ac.pack","sortValue":0}},"environmentRef":"dc01ec6a2d0d4bdfb47d3671125c06bd.environment","dataModelVersion":2,"modified":"2016-05-06T09:27:35.542733+00:00","entities":{"a0960f37dd19450285607dbff446ffc4.entity":{"entityRef":"a0960f37dd19450285607dbff446ffc4.entity","sortValue":19},"a2d72c434089483abc8289b98f71b8b1.entity":{"entityRef":"a2d72c434089483abc8289b98f71b8b1.entity","sortValue":9},"16c98b042c0d4f39b36ab4b7831fb308.entity":{"entityRef":"16c98b042c0d4f39b36ab4b7831fb308.entity","sortValue":7},"e37286e8664948c88c3b7fe0e165619e.entity":{"entityRef":"e37286e8664948c88c3b7fe0e165619e.entity","sortValue":18},"4b89354ffce14b939d098ff721788b67.entity":{"entityRef":"4b89354ffce14b939d098ff721788b67.entity","sortValue":8},"95fe2687cf6e4f5384ee638ea46d539f.entity":{"entityRef":"95fe2687cf6e4f5384ee638ea46d539f.entity","sortValue":16},"d1546a4dd10a47889863d5661418ee19.entity":{"entityRef":"d1546a4dd10a47889863d5661418ee19.entity","sortValue":1},"0d1ab50be913487ab8471e6404632e22.entity":{"entityRef":"0d1ab50be913487ab8471e6404632e22.entity","sortValue":14},"7dd860ba25584de1af34fe242edcdbb0.entity":{"entityRef":"7dd860ba25584de1af34fe242edcdbb0.entity","sortValue":2},"46daab6dafd543dba7d9acf5e1741e7c.entity":{"entityRef":"46daab6dafd543dba7d9acf5e1741e7c.entity","sortValue":13},"03749b918c6a4d4a9248c9b4e8c852a0.entity":{"entityRef":"03749b918c6a4d4a9248c9b4e8c852a0.entity","sortValue":21},"ff811e20fd8949059a7b00a16bc70a48.entity":{"entityRef":"ff811e20fd8949059a7b00a16bc70a48.entity","sortValue":12},"3be4ae77975a4df9bb1b134eef605dda.entity":{"entityRef":"3be4ae77975a4df9bb1b134eef605dda.entity","sortValue":20},"703fbe0d998840b29802c00691f9da91.entity":{"entityRef":"703fbe0d998840b29802c00691f9da91.entity","sortValue":5},"c17f0a9d5a6740358abf80f3c062b673.entity":{"entityRef":"c17f0a9d5a6740358abf80f3c062b673.entity","sortValue":11},"3d331d7b8a7546e29c8ad2042f83e3ab.entity":{"entityRef":"3d331d7b8a7546e29c8ad2042f83e3ab.entity","sortValue":22},"8f2eda3b8dac4902b4e19e5f5a75e2c0.entity":{"entityRef":"8f2eda3b8dac4902b4e19e5f5a75e2c0.entity","sortValue":0},"8f6340ded0104beea74f0c3d18d64565.entity":{"entityRef":"8f6340ded0104beea74f0c3d18d64565.entity","sortValue":17},"27f89a3380c44a9a94a1f7894b9a5805.entity":{"entityRef":"27f89a3380c44a9a94a1f7894b9a5805.entity","sortValue":15}},"posteffectsRef":"64dd795705e44c63802029c51c083436.posteffects","editorCameraSettings":{"camera3d":{"spherical":[4.869040592130064,1.3153981633974436,0.13359877559829858],"lookAtPoint":[0,0,0]},"camera2d":{"spherical":[2,3.141592653589793,0],"lookAtPoint":[0,0,0]}},"defaultPackRef":"5f9b57a637664673b655e3981291f6ac.pack","thumbnailRef":"7c14773824edcdd6cb1e5ae8d412b3d147f87a64.jpg","id":"e53ee6df73fd4a6eaf98558e4dbb3c9c.scene","tags":{}},"binaries":["7c14773824edcdd6cb1e5ae8d412b3d147f87a64.jpg","3b6f27e5fc7eaa528c687a139569b0091a8addc8.jpg","0341234c6604565e332c2a864112457382432ee4.wav","b88dc2d382ad42e5bb11822d0e366eaa1a5a364f.mp3","5bf486f06882cbc53ec3819fb900b3a0c17cd0e4.jpg","63a6f697e62e887ca54aab6d9b58fa319f7ba611.jpg","b22e04e2c43699c2c427ceaa3ff99d9886c2335b.jpg","91697bfea1d925a47713ee559251613925e98585.jpg","46dcbbc4984cac1e4afb67d376e6928f8425a124.wav","6e2ec0ce7bcaffa4a34ca7f04c6100efd7d7470a.jpg","fa1baca4a8742746a050779badc857e8d6a2bde3.mp3","a3e8e51f5759f231eaaaf2929cec976505897dfb.mp3","bfe2a49cc6fca30195f223b1c3411e2798e2bc9e.jpg","02c34e8664d3fec5332f0dd0bb4a7a14c003a043.wav","65c2b8a753417bb23f62ba01110f99fb0e2ca840.mp3","0f98e66ecb6742d01a942b3e7cc2a6fe7a651f1d.png","2a11da17656ff34d17dcb80a224f106642750451.mp3","82d74d02af75cdcf460564f0edd3db1db0a4b6bd.jpg"],"68be5d7202654290b97aa79b097bfb65.texture":{"wrapS":"Repeat","minFilter":"BilinearNoMipMaps","imageRef":"6e2ec0ce7bcaffa4a34ca7f04c6100efd7d7470a.jpg","license":"CC0","flipY":false,"deleted":false,"name":"texture_47","magFilter":"Bilinear","created":"2014-12-09T10:18:24.040118+00:00","dataModelVersion":2,"modified":"2014-12-09T10:18:24.040139+00:00","repeat":[0,0],"anisotropy":1,"offset":[0,0],"id":"68be5d7202654290b97aa79b097bfb65.texture","generateMipmaps":true,"originalLicense":"CC0","wrapT":"Repeat"},"27f89a3380c44a9a94a1f7894b9a5805.entity":{"name":"Overhead cam","license":"CC0","created":"2014-12-09T10:18:24.284538+00:00","deleted":false,"tags":{},"dataModelVersion":2,"modified":"2014-12-09T10:49:58.256866+00:00","static":false,"components":{"camera":{"fov":45,"lockedRatio":false,"far":1000,"followEditorCam":true,"projectionMode":"Perspective","near":1,"aspect":1,"size":100},"transform":{"rotation":[-7.654645989897879,14.633236858066638,0],"scale":[1,1,1],"translation":[1.219107812793741,0.6485645047269983,4.669121599594914],"children":{"9f0a88bf374c4842bc6cdaeed0cf0164.entity":{"entityRef":"9f0a88bf374c4842bc6cdaeed0cf0164.entity","sortValue":0}}}},"hidden":false,"id":"27f89a3380c44a9a94a1f7894b9a5805.entity"}}