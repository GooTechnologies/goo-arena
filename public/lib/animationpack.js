webpackJsonp([1],[function(a,b,c){a.exports=c(59)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(a,b,c){if(a.exports={Source:c(60),BinaryLerpSource:c(61),ClipSource:c(63),FrozenClipSource:c(65),ManagedTransformSource:c(66),AbstractAnimationChannel:c(67),AnimationClip:c(68),AnimationClipInstance:c(64),InterpolatedFloatChannel:c(69),JointChannel:c(70),JointData:c(72),TransformChannel:c(71),TransformData:c(62),TriggerChannel:c(73),TriggerData:c(74),AnimationComponent:c(75),AnimationClipHandler:c(84),AnimationComponentHandler:c(87),AnimationHandlers:c(89),AnimationLayersHandler:c(90),AnimationStateHandler:c(91),SkeletonHandler:c(92),Joint:c(93),AnimationLayer:c(76),LayerLerpBlender:c(83),Skeleton:c(94),SkeletonPose:c(95),AbstractState:c(79),AbstractTransitionState:c(78),FadeTransitionState:c(77),FrozenTransitionState:c(81),SteadyState:c(82),SyncFadeTransitionState:c(80),AnimationSystem:c(96)},"undefined"!=typeof window)for(var d in a.exports)window.goo[d]=a.exports[d]},function(a,b){function c(){}c.prototype.getSourceData=function(){},c.prototype.setTime=function(){return!0},c.prototype.resetClips=function(){},c.prototype.shiftClipTime=function(){},c.prototype.setTimeScale=function(){},c.prototype.isActive=function(){return!0},c.prototype.clone=function(){},a.exports=c},function(a,b,c){function d(a,b,c){g.call(this),this._sourceA=a?a:null,this._sourceB=b?b:null,this.blendWeight=c?c:null}var e=c(9),f=c(62),g=c(60);d.prototype=Object.create(g.prototype),d.prototype.constructor=d,d.prototype.getSourceData=function(){var a=this._sourceA?this._sourceA.getSourceData():null,b=this._sourceB?this._sourceB.getSourceData():null;return d.combineSourceData(a,b,this.blendWeight)},d.prototype.setTime=function(a){var b=!1,c=!1;return this._sourceA&&(b=this._sourceA.setTime(a)),this._sourceB&&(c=this._sourceB.setTime(a)),b||c},d.prototype.resetClips=function(a){this._sourceA&&this._sourceA.resetClips(a),this._sourceB&&this._sourceB.resetClips(a)},d.prototype.shiftClipTime=function(a){this._sourceA&&this._sourceA.shiftClipTime(a),this._sourceB&&this._sourceB.shiftClipTime(a)},d.prototype.setTimeScale=function(a){this._sourceA.setTimeScale(a),this._sourceB.setTimeScale(a)},d.prototype.isActive=function(){var a=!1;return this._sourceA&&(a=a||this._sourceA.isActive()),this._sourceB&&(a=a||this._sourceB.isActive()),a},d.combineSourceData=function(a,b,c,e){if(!b)return a;if(!a)return b;var g=e?e:{};for(var h in a){var i=a[h],j=b[h];isNaN(i)?i instanceof f?j?g[h]=i.blend(j,c,g[h]):g[h]?g[h].set(i):g[h]=new i.constructor(i):g[h]=i:d.blendFloatValues(g,h,c,i,j)}for(var h in b)g[h]||(g[h]=b[h]);return g},d.blendFloatValues=function(a,b,c,d,f){isNaN(f)?a[b]=d:a[b]=e.lerp(c,d[0],f[0])},d.prototype.clone=function(){return new d(this._sourceA,this._sourceB,this._blendWeight)},a.exports=d},function(a,b,c){function d(a){this._rotation=(new e).copy(a?a._rotation:e.IDENTITY),this._scale=(new f).copy(a?a._scale:f.ONE),this._translation=(new f).copy(a?a._translation:f.ZERO)}var e=c(23),f=c(8);d.prototype.applyTo=function(a){a.rotation.copyQuaternion(this._rotation),a.scale.set(this._scale),a.translation.set(this._translation),a.update()},d.prototype.set=function(a){this._rotation.copy(a._rotation),this._scale.copy(a._scale),this._translation.copy(a._translation)},d.prototype.blend=function(a,b,c){var f=c?c:new d;return f._translation.set(this._translation).lerp(a._translation,b),f._scale.set(this._scale).lerp(a._scale,b),e.slerp(this._rotation,a._rotation,b,f._rotation),f},a.exports=d},function(a,b,c){function d(a,b,c){g.call(this),this._clip=a,this._clipInstance=new f,this._filterChannels={},this._filter=null,this.setFilter(b,c),this._startTime=-(1/0),this._endTime=1/0,this.currentLoop=0}var e=c(9),f=c(64),g=c(60);d.prototype=Object.create(g.prototype),d.prototype.constructor=d,d.prototype.setFilter=function(a,b){if(a&&b){this._filter=["Exclude","Include"].indexOf(a)>-1?a:null;for(var c=0;c<b.length;c++)this._filterChannels[b[c]]=!0}else this._filter=null},d.prototype.setTime=function(a){var b=this._clipInstance;"number"!=typeof b._startTime&&(b._startTime=a);var c,d;if(b._active){0!==b._timeScale?(b._prevUnscaledClockTime=a-b._startTime,c=b._timeScale*b._prevUnscaledClockTime,b._prevClockTime=c):c=b._prevClockTime;var f=Math.min(this._clip._maxTime,this._endTime),g=Math.max(this._startTime,0);if(d=f-g,-1===f)return!1;0!==f&&(this.currentLoop=Math.floor(c/d),-1===b._loopCount?(0>c?(c*=-1,c%=d,c=d-c):c%=d,c+=g):b._loopCount>0&&d*b._loopCount>=Math.abs(c)&&(0>c?(c*=-1,c%=d,c=d-c):c%=d,c+=g),(c>f||g>c)&&(c=e.clamp(c,g,f),b._active=!1)),this._clip.update(c,b)}return b._active},d.prototype.resetClips=function(a){this._clipInstance._startTime="undefined"!=typeof a?a:0,this._clipInstance._active=!0},d.prototype.shiftClipTime=function(a){this._clipInstance._startTime+=a,this._clipInstance._active=!0},d.prototype.setTimeScale=function(a){this._clipInstance.setTimeScale(a)},d.prototype.isActive=function(){return this._clipInstance._active&&-1!==this._clip._maxTime},d.prototype.getSourceData=function(){if(!this._filter||!this._filterChannels)return this._clipInstance._clipStateObjects;var a=this._clipInstance._clipStateObjects,b={},c="Include"===this._filter;for(var d in a)void 0!==this._filterChannels[d]===c&&(b[d]=a[d]);return b},d.prototype.clone=function(){var a=new d(this._clip);a._clipInstance=this._clipInstance.clone(),a._filter=this._filter;for(var b in this._filterChannels)a._filterChannels[b]=this._filterChannels[b];return a._startTime=this._startTime,a._endTime=this._endTime,a},a.exports=d},function(a,b,c){function d(){this._active=!0,this._loopCount=0,this._timeScale=1,this._startTime=0,this._prevClockTime=0,this._prevUnscaledClockTime=0,this._clipStateObjects={}}var e=c(34);d.prototype.setTimeScale=function(a,b){if(b="undefined"!=typeof b?b:e.time,this._active&&this._timeScale!==a)if(0!==this._timeScale&&0!==a){var c=b,d=c-this._startTime;d*=this._timeScale,d/=a,this._startTime=c-d}else if(0===this._timeScale){var c=b;this._startTime=c-this._prevUnscaledClockTime}this._timeScale=a},d.prototype.getApplyTo=function(a){var b=a._channelName,c=this._clipStateObjects[b];return c||(c=a.createStateDataObject(),this._clipStateObjects[b]=c),c},d.prototype.clone=function(){var a=new d;return a._active=this._active,a._loopCount=this._loopCount,a._timeScale=this._timeScale,a},a.exports=d},function(a,b,c){function d(a,b){e.call(this),this._source=a,this._time=b}var e=c(60);d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.getSourceData=function(){return this._source.getSourceData()},d.prototype.resetClips=function(){this._source.resetClips(0)},d.prototype.setTime=function(){return this._source.setTime(this._time),!0},d.prototype.clone=function(){var a=new d(this._source.clone(),this._time);return a},a.exports=d},function(a,b,c){function d(a){h.call(this),this._sourceName=a?a:null,this._data={}}var e=c(62),f=c(8),g=c(23),h=c(60);d.prototype=Object.create(h.prototype),d.prototype.constructor=d,d.prototype.setTranslation=function(a,b){var c=this._data[a];c instanceof e&&c._translation.set(b)},d.prototype.getTranslation=function(a,b){var c=this._data[a];return c instanceof e&&(b=b||new f,b.set(c._translation)),b},d.prototype.setScale=function(a,b){var c=this._data[a];c instanceof e&&c._scale.set(b)},d.prototype.getScale=function(a,b){var c=this._data[a];return c instanceof e&&(b=b||new f,b.set(c._scale)),b},d.prototype.setRotation=function(a,b){var c=this._data[a];c instanceof e&&c._rotation.set(b)},d.prototype.getRotation=function(a,b){var c=this._data[a];return c instanceof e&&(b=b||new g,b.set(c._rotation)),b},d.prototype.initFromClip=function(a,b,c){if("Include"===b&&c&&c.length)for(var d=0,e=c.length;e>d;d++){var f=c[d],g=a.findChannelByName(f);if(g){var h=g.getData(0);this._data[f]=h}else console.error("Channel not in clip: "+f)}else for(var d=0,e=a._channels.length;e>d;d++){var g=a._channels[d],f=g._channelName;if("Exclude"===b&&c&&c.length&&c.indexOf(f)>-1){var h=g.getData(0);this._data[f]=h}}},d.prototype.getChannelData=function(a){return this._data[a]},d.prototype.getSourceData=function(){return this._data},d.prototype.clone=function(){var a={};for(var b in this._data)a[b]=this._data[b].clone();return new d(this._sourceName,a)},a.exports=d},function(a,b,c){function d(a,b,c){this._blendType=c||d.BLENDTYPES.LINEAR,this._channelName=a,(b instanceof Array||b instanceof Float32Array)&&b.length?this._times=new Float32Array(b):this._times=[],this._lastStartFrame=0}var e=c(9);d.BLENDTYPES={},d.BLENDTYPES.LINEAR="Linear",d.BLENDTYPES.CUBIC="SCurve3",d.BLENDTYPES.QUINTIC="SCurve5",d.prototype.getSampleCount=function(){return this._times.length},d.prototype.getMaxTime=function(){return this._times.length?this._times[this._times.length-1]:0},d.prototype.updateSample=function(a,b){var c=this._times.length;if(c){var f=c-1;if(0>a||1===c)this.setCurrentSample(0,0,b);else if(a>=this._times[f])this.setCurrentSample(f,0,b);else{var g=0;if(a>=this._times[this._lastStartFrame]){g=this._lastStartFrame;for(var h=this._lastStartFrame;c-1>h&&!(this._times[h]>=a);h++)g=h}else for(var h=0;h<this._lastStartFrame&&!(this._times[h]>=a);h++)g=h;var i=(a-this._times[g])/(this._times[g+1]-this._times[g]);switch(this._blendType){case d.BLENDTYPES.CUBIC:i=e.scurve3(i);break;case d.BLENDTYPES.QUINTIC:i=e.scurve5(i)}this.setCurrentSample(g,i,b),this._lastStartFrame=g}}},a.exports=d},function(a,b){function c(a,b){this._name=a,this._channels=b||[],this._maxTime=-1,this.updateMaxTimeIndex()}c.prototype.update=function(a,b){for(var c=0,d=this._channels.length;d>c;++c){var e=this._channels[c],f=b.getApplyTo(e);e.updateSample(a,f)}},c.prototype.addChannel=function(a){this._channels.push(a),this.updateMaxTimeIndex()},c.prototype.removeChannel=function(a){var b=this._channels.indexOf(a);return b>=0?(this._channels.splice(b,1),this.updateMaxTimeIndex(),!0):!1},c.prototype.findChannelByName=function(a){for(var b=0,c=this._channels.length;c>b;++b){var d=this._channels[b];if(a===d._channelName)return d}return null},c.prototype.updateMaxTimeIndex=function(){this._maxTime=-1;for(var a,b=0;b<this._channels.length;b++){var c=this._channels[b];a=c.getMaxTime(),a>this._maxTime&&(this._maxTime=a)}},c.prototype.toString=function(){return this._name+": "+this._channels.map(function(a){return a._channelName})},a.exports=c},function(a,b,c){function d(a,b,c,d){e.call(this,a,b,d),this._values=c?c.slice(0):null}var e=c(67),f=c(9);d.prototype=Object.create(e.prototype),d.prototype.createStateDataObject=function(){return[0]},d.prototype.setCurrentSample=function(a,b,c){c[0]=f.lerp(b,this._values[a],this._values[a+1])},d.prototype.getData=function(a,b){var c=b||[];return c[0]=this._values[a],c},a.exports=d},function(a,b,c){function d(a,b,c,d,f,g,h){e.call(this,b,c,d,f,g,h),this._jointName=b,this._jointIndex=a}var e=c(71),f=c(72);d.prototype=Object.create(e.prototype),d.JOINT_CHANNEL_NAME="_jnt",d.prototype.createStateDataObject=function(){return new f},d.prototype.setCurrentSample=function(a,b,c){e.prototype.setCurrentSample.call(this,a,b,c),c._jointIndex=this._jointIndex},d.prototype.getData=function(a,b){var c=b?b:new f;return e.prototype.getData.call(this,a,c),c._jointIndex=this._jointIndex,c},a.exports=d},function(a,b,c){function d(a,b,c,d,f,g){if(e.call(this,a,b,g),c.length/4!==b.length||d.length/3!==b.length||f.length/3!==b.length)throw new Error("All provided arrays must be the same length (accounting for type)! Channel: "+a);this._rotations=new Float32Array(c),this._translations=new Float32Array(d),this._scales=new Float32Array(f)}var e=c(67),f=c(62),g=c(23),h=new g,i=new g;d.prototype=Object.create(e.prototype),d.prototype.createStateDataObject=function(){return new f},d.prototype.setCurrentSample=function(a,b,c){var d=c,e=4*a,f=3*a,j=4*(a+1),k=3*(a+1);return 0===b?(d._rotation.x=this._rotations[e+0],d._rotation.y=this._rotations[e+1],d._rotation.z=this._rotations[e+2],d._rotation.w=this._rotations[e+3],d._translation.x=this._translations[f+0],d._translation.y=this._translations[f+1],d._translation.z=this._translations[f+2],d._scale.x=this._scales[f+0],d._scale.y=this._scales[f+1],void(d._scale.z=this._scales[f+2])):1===b?(d._rotation.x=this._rotations[j+0],d._rotation.y=this._rotations[j+1],d._rotation.z=this._rotations[j+2],d._rotation.w=this._rotations[j+3],d._translation.x=this._translations[k+0],d._translation.y=this._translations[k+1],d._translation.z=this._translations[k+2],d._scale.x=this._scales[k+0],d._scale.y=this._scales[k+1],void(d._scale.z=this._scales[k+2])):(d._rotation.x=this._rotations[e+0],d._rotation.y=this._rotations[e+1],d._rotation.z=this._rotations[e+2],d._rotation.w=this._rotations[e+3],h.x=this._rotations[j+0],h.y=this._rotations[j+1],h.z=this._rotations[j+2],h.w=this._rotations[j+3],d._rotation.equals(h)||(g.slerp(d._rotation,h,b,i),d._rotation.set(i)),d._translation.setDirect((1-b)*this._translations[f+0]+b*this._translations[k+0],(1-b)*this._translations[f+1]+b*this._translations[k+1],(1-b)*this._translations[f+2]+b*this._translations[k+2]),void d._scale.setDirect((1-b)*this._scales[f+0]+b*this._scales[k+0],(1-b)*this._scales[f+1]+b*this._scales[k+1],(1-b)*this._scales[f+2]+b*this._scales[k+2]))},d.prototype.getData=function(a,b){var c=b?b:new f;return this.setCurrentSample(a,0,c),c},a.exports=d},function(a,b,c){function d(a){e.call(this,a),this._jointIndex=a?a._jointIndex:0}var e=c(62);d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.set=function(a){e.prototype.set.call(this,a),this._jointIndex=a._jointIndex},d.prototype.blend=function(a,b,c){var f=c;return f?f instanceof d&&(f._jointIndex=this._jointIndex):(f=new d,f._jointIndex=this._jointIndex),e.prototype.blend.call(this,a,b,f)},d.prototype.clone=function(){return new d(this)},a.exports=d},function(a,b,c){function d(a,b,c,d){e.call(this,a,b,d),this._keys=c?c.slice(0):null,this.guarantee=!1}var e=c(67),f=c(74);d.prototype=Object.create(e.prototype),d.prototype.createStateDataObject=function(){return new f},d.prototype.setCurrentSample=function(a,b,c){var d=c._currentIndex,e=1!==b?a:a+1;if(d!==e&&this.guarantee){var f=[];if(d>e){for(var g=d+1;g<this._keys.length;g++)f.push(this._keys[g]);d=-1}for(var g=d+1;e>=g;g++)f.push(this._keys[g]);c.arm(e,f)}else c.arm(e,[this._keys[e]])},a.exports=d},function(a,b){function c(){this._currentTriggers=[],this._currentIndex=-1,this.armed=!1}c.prototype.arm=function(a,b){if(null===b||0===b.length)this._currentTriggers.length=0,this.armed=!1;else if(a!==this._currentIndex){this._currentTriggers.length=0;for(var c=0,d=b.length;d>c;c++)b[c]&&""!==b[c]&&this._currentTriggers.push(b[c]);this.armed=!0}this._currentIndex=a},a.exports=c},function(a,b,c){function d(a){e.apply(this,arguments),this.type="AnimationComponent",this.layers=[],this.floats={},this._updateRate=1/60,this._lastUpdate=0,this._triggerCallbacks={};var b=new g(g.BASE_LAYER_NAME);this.layers.push(b),this._skeletonPose=a,this.paused=!1,this.lastTimeOfPause=-1}var e=c(20),f=c(34),g=c(76),h=c(72),i=c(62),j=c(74);d.type="AnimationComponent",d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.transitionTo=function(a,b,c){return this.layers[0].transitionTo(a,void 0,c)?!0:b?this.layers[0].setCurrentStateById(a,!0,void 0,c):!1},d.prototype.getStates=function(){return this.layers[0].getStates()},d.prototype.getCurrentState=function(){return this.layers[0].getCurrentState()},d.prototype.getTransitions=function(){return this.layers[0].getTransitions()},d.prototype.update=function(a){if(!this.paused){if(a="undefined"!=typeof a?a:f.time,0!==this._updateRate){if(a>this._lastUpdate&&a-this._lastUpdate<this._updateRate)return;this._lastUpdate=a-(a-this._lastUpdate)%this._updateRate}for(var b=0,c=this.layers.length;c>b;b++)this.layers[b].update(a)}},d.prototype.apply=function(a){var b=this.getCurrentSourceData();if(b){for(var c=this._skeletonPose,d=Object.keys(b),e=0,f=d.length;f>e;e++){var g=d[e],k=b[g];if(k instanceof h)c&&k._jointIndex>=0&&k.applyTo(c._localTransforms[k._jointIndex]);else if(k instanceof i)a&&(a.sync(),k.applyTo(a.transform));else if(k instanceof j){if(k.armed){for(var e=0,l=k._currentTriggers.length;l>e;e++){var m=this._triggerCallbacks[k._currentTriggers[e]];if(m&&m.length)for(var n=0,o=m.length;o>n;n++)m[n]()}k.armed=!1}}else k instanceof Array&&(this.floats[g]=k[0])}c&&c.updateTransforms()}},d.prototype.postUpdate=function(){for(var a=0,b=this.layers.length;b>a;a++)this.layers[a].postUpdate()},d.prototype.getCurrentSourceData=function(){if(0===this.layers.length)return[];var a=this.layers.length-1;this.layers[0]._layerBlender=null;for(var b=0;a>b;b++)this.layers[b+1].updateLayerBlending(this.layers[b]);return this.layers[a].getCurrentSourceData()},d.prototype.addLayer=function(a,b){isNaN(b)?this.layers.push(a):this.layers.splice(b,0,a)},d.prototype.resetClips=function(a){for(var b=0;b<this.layers.length;b++)this.layers[b].resetClips(a)},d.prototype.shiftClipTime=function(a){for(var b=0;b<this.layers.length;b++)this.layers[b].shiftClipTime(a)},d.prototype.setTimeScale=function(a){for(var b=0;b<this.layers.length;b++)this.layers[b].setTimeScale(a)},d.prototype.pause=function(){this.paused||(this.lastTimeOfPause=f.time,this.paused=!0)},d.prototype.stop=function(){this._skeletonPose&&this._skeletonPose.setToBindPose(),this.paused=!0,this.lastTimeOfPause=-1},d.prototype.resume=function(){(this.paused||-1===this.lastTimeOfPause)&&(-1===this.lastTimeOfPause?this.resetClips(f.time):this.shiftClipTime(f.time-this.lastTimeOfPause)),this.paused=!1},d.prototype.clone=function(){var a=new d;return a.layers=this.layers.map(function(a){return a.clone()}),a},a.exports=d},function(a,b,c){function d(a,b){this.id=b,this._name=a,this._steadyStates={},this._currentState=null,this._layerBlender=new i,this._transitions={},this._transitionStates={}}var e=c(77),f=c(80),g=c(81),h=c(82),i=c(83),j=c(34),k=c(9);d.BASE_LAYER_NAME="-BASE_LAYER-",d.prototype.getStates=function(){return Object.keys(this._steadyStates)},d.prototype.setState=function(a,b){this._steadyStates[a]=b},d.prototype.setBlendWeight=function(a){this._layerBlender&&(this._layerBlender._blendWeight=k.clamp(a,0,1))},d.prototype.getTransitions=function(){var a;if(a=this._currentState?Object.keys(this._currentState._transitions):[],this._transitions)for(var b in this._transitions)-1===a.indexOf(b)&&a.push(b);return a.sort(),a},d.prototype.update=function(a){this._currentState&&this._currentState.update("undefined"!=typeof a?a:j.time)},d.prototype.postUpdate=function(){this._currentState&&this._currentState.postUpdate()},d.prototype.transitionTo=function(a,b,c){b="undefined"!=typeof b?b:j.time;var d,e=this._currentState;if(this._steadyStates[a]===e)return!1;if(!this._steadyStates[a])return!1;if(e&&e._transitions&&(d=e._transitions[a]||e._transitions["*"]),!d&&this._transitions&&(d=this._transitions[a]||this._transitions["*"]),e instanceof h&&d){var f=this._getTransitionByType(d.type);return this._doTransition(f,e,this._steadyStates[a],d,b,c),!0}if(!e&&(d=this._transitions[a])){var f=this._getTransitionByType(d.type);if(f)return this._doTransition(f,null,this._steadyStates[a],d,b,c),!0}return!1},d.prototype._doTransition=function(a,b,c,d,e,f){if(b){a._sourceState=b;var g=d.timeWindow||[-1,-1];if(!a.isValid(g,e))return void console.warn("State not in allowed time window");b.onFinished=null}a._targetState=c,a.readFromConfig(d),this.setCurrentState(a,!0,e,f)},d.prototype.setCurrentState=function(a,b,c,d){c="undefined"!=typeof c?c:j.time,this._currentState=a,a&&(b&&a.resetClips(c),a.onFinished=function(){this.setCurrentState(a._targetState||null,!1,void 0,d),a instanceof h&&d instanceof Function&&d(),this.update()}.bind(this))},d.prototype.getCurrentState=function(){return this._currentState},d.prototype.setCurrentStateById=function(a,b,c,d){var e=this.getStateById(a);this.setCurrentState(e,b,c,d)},d.prototype.getStateById=function(a){return this._steadyStates[a]},d.prototype.getStateByName=function(a){for(var b in this._steadyStates){var c=this._steadyStates[b];if(c._name===a)return this._steadyStates[b]}},d.prototype.setCurrentStateByName=function(a,b,c){if(a){var d=this.getStateByName(a);if(d)return this.setCurrentState(d,b,c),!0;console.warn("unable to find SteadyState named: "+a)}return!1},d.prototype.getCurrentSourceData=function(){return this._layerBlender?this._layerBlender.getBlendedSourceData():this._currentState?this._currentState.getCurrentSourceData():null},d.prototype.updateLayerBlending=function(a){this._layerBlender&&(this._layerBlender._layerA=a,this._layerBlender._layerB=this)},d.prototype.clearCurrentState=function(){this.setCurrentState(null)},d.prototype.resetClips=function(a){this._currentState&&this._currentState.resetClips("undefined"!=typeof a?a:j.time)},d.prototype.shiftClipTime=function(a){this._currentState&&this._currentState.shiftClipTime("undefined"!=typeof a?a:0)},d.prototype.setTimeScale=function(a){this._currentState&&this._currentState.setTimeScale(a)},d.prototype._getTransitionByType=function(a){if(this._transitionStates[a])return this._transitionStates[a];var b;switch(a){case"Fade":b=new e;break;case"SyncFade":b=new f;break;case"Frozen":b=new g;break;default:console.log("Defaulting to frozen transition type"),b=new g}return this._transitionStates[a]=b},d.prototype.clone=function(){var a=new d(this._name);for(var b in this._steadyStates)a._steadyStates[b]=this._steadyStates[b].clone(),this._steadyStates[b]===this._currentState&&(a._currentState=a._steadyStates[b]);for(var b in this._transitions)a._transitions[b]=this._transitions[b];for(var b in this._transitionStates)a._transitionStates[b]=new this._transitionStates[b].constructor;return a},a.exports=d},function(a,b,c){function d(){e.call(this)}var e=c(78);d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.update=function(a){e.prototype.update.call(this,a),this._sourceState&&this._sourceState.update(a),this._targetState&&this._targetState.update(a)},d.prototype.getCurrentLoop=function(){return this._targetState.getCurrentLoop()},d.prototype.postUpdate=function(){this._sourceState&&this._sourceState.postUpdate(),this._targetState&&this._targetState.postUpdate()},d.prototype.resetClips=function(a){e.prototype.resetClips.call(this,a),this._targetState&&this._targetState.resetClips(a)},d.prototype.shiftClipTime=function(a){e.prototype.shiftClipTime.call(this,a),this._targetState&&this._targetState.shiftClipTime(a),this._sourceState&&this._sourceState.shiftClipTime(a)},a.exports=d},function(a,b,c){function d(){e.call(this),this._sourceState=null,this._targetState=null,this._percent=0,this._sourceData=null,this._fadeTime=0,this._blendType=d.BLENDTYPES.LINEAR}var e=c(79),f=c(61),g=c(9);d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.BLENDTYPES={},d.BLENDTYPES.LINEAR="Linear",d.BLENDTYPES.CUBIC="SCurve3",d.BLENDTYPES.QUINTIC="SCurve5",d.prototype.getCurrentLoop=function(){return 0},d.prototype.update=function(a){var b=a-this._globalStartTime;if(b>this._fadeTime&&this.onFinished)return void this.onFinished();var c=b/this._fadeTime;switch(this._blendType){case d.BLENDTYPES.CUBIC:this._percent=g.scurve3(c);break;case d.BLENDTYPES.QUINTIC:this._percent=g.scurve5(c);break;default:this._percent=c}},d.prototype.readFromConfig=function(a){a&&(void 0!==a.fadeTime&&(this._fadeTime=a.fadeTime),void 0!==a.blendType&&(this._blendType=a.blendType))},d.prototype.getCurrentSourceData=function(){var a=this._sourceState?this._sourceState.getCurrentSourceData():null,b=this._targetState?this._targetState.getCurrentSourceData():null;return this._sourceData||(this._sourceData={}),f.combineSourceData(a,b,this._percent,this._sourceData)},d.prototype.isValid=function(a,b){var c=b-this._sourceState._globalStartTime,d=a[0],e=a[1];return 0>=d?0>=e?!0:e>=c:0>=e?c>=d:e>=d?c>=d&&e>=c:c>=d||e>=c},d.prototype.resetClips=function(a){e.prototype.resetClips.call(this,a),this._percent=0},d.prototype.shiftClipTime=function(a){e.prototype.shiftClipTime.call(this,a)},d.prototype.setTimeScale=function(a){this._sourceState&&this._sourceState.setTimeScale(a),this._targetState&&this._targetState.setTimeScale(a)},a.exports=d},function(a,b){function c(){this._globalStartTime=0,this.onFinished=null}c.prototype.update=function(){},c.prototype.postUpdate=function(){},c.prototype.getCurrentSourceData=function(){},c.prototype.resetClips=function(a){this._globalStartTime=a},c.prototype.shiftClipTime=function(a){this._globalStartTime+=a},a.exports=c},function(a,b,c){function d(){e.call(this)}var e=c(77);d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.resetClips=function(a){e.prototype.resetClips.call(this,a),this._targetState.resetClips(this._sourceState._globalStartTime)},d.prototype.shiftClipTime=function(a){e.prototype.shiftClipTime.call(this,a),this._targetState.shiftClipTime(this._sourceState._globalStartTime+a),this._sourceState.shiftClipTime(a)},a.exports=d},function(a,b,c){function d(){e.call(this)}var e=c(78);d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.update=function(a){e.prototype.update.call(this,a),this._targetState&&this._targetState.update(a)},d.prototype.postUpdate=function(){this._targetState&&this._targetState.postUpdate()},d.prototype.resetClips=function(a){e.prototype.resetClips.call(this,a),this._targetState.resetClips(a)},d.prototype.shiftClipTime=function(a){e.prototype.shiftClipTime.call(this,a),this._targetState.shiftClipTime(a)},a.exports=d},function(a,b,c){function d(a){e.call(this),this.id=null,this._name=a,this._transitions={},this._sourceTree=null}var e=c(79);d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setClipSource=function(a){this._sourceTree=a},d.prototype.update=function(a){this._sourceTree.setTime(a)||this.onFinished&&this.onFinished()},d.prototype.getCurrentSourceData=function(){return this._sourceTree.getSourceData()},d.prototype.getCurrentLoop=function(){return this._sourceTree.currentLoop},d.prototype.resetClips=function(a){e.prototype.resetClips.call(this,a),this._sourceTree.resetClips(a)},d.prototype.shiftClipTime=function(a){e.prototype.shiftClipTime.call(this,a),this._sourceTree.shiftClipTime(a)},d.prototype.setTimeScale=function(a){this._sourceTree.setTimeScale(a)},d.prototype.clone=function(){var a=new d(this._name);for(var b in this._transitions)a._transitions[b]=this._transitions[b];return a._sourceTree=this._sourceTree.clone(),a},a.exports=d},function(a,b,c){function d(){this._blendWeight=null,this._layerA=null,this._layerB=null}var e=c(61);d.prototype.getBlendedSourceData=function(){var a=this._layerA.getCurrentSourceData(),b=this._layerB._currentState?this._layerB._currentState.getCurrentSourceData():null;return e.combineSourceData(a,b,this._blendWeight)},a.exports=d},function(a,b,c){function d(){e.apply(this,arguments)}var e=c(85),f=c(68),g=c(70),h=c(71),i=c(69),j=c(73),k=c(86);d.prototype=Object.create(e.prototype),d.prototype.constructor=d,e._registerClass("clip",d),d.prototype._create=function(){return new f},d.prototype._update=function(a,b,c){var d=this;return e.prototype._update.call(this,a,b,c).then(function(a){return a?d.loadObject(b.binaryRef,c).then(function(c){if(!c)throw new Error("Binary clip data was empty");return d._updateAnimationClip(b,c,a)}):a})},d.prototype._updateAnimationClip=function(a,b,c){if(c._channels=[],a.channels)for(var d=Object.keys(a.channels),e=0;e<d.length;e++){var f,l=a.channels[d[e]],m=k.getTypedArray(b,l.times),n=l.blendType,o=l.type;switch(o){case"Joint":case"Transform":var p,q,r;p=k.getTypedArray(b,l.rotationSamples),q=k.getTypedArray(b,l.translationSamples),r=k.getTypedArray(b,l.scaleSamples),f="Joint"===o?new g(l.jointIndex,l.name,m,p,q,r,n):new h(l.name,m,p,q,r,n);break;case"FloatLERP":f=new i(l.name,m,l.values,n);break;case"Trigger":f=new j(l.name,m,l.keys),f.guarantee=!!l.guarantee;break;default:console.warn("Unhandled channel type: "+l.type);continue}c.addChannel(f)}return c},a.exports=d},,,function(a,b,c){function d(){e.apply(this,arguments),this._type="AnimationComponent"}var e=c(88),f=c(75),g=c(55);d.prototype=Object.create(e.prototype),d.prototype.constructor=d,e._registerClass("animation",d),d.prototype._create=function(){return new f},d.prototype.update=function(a,b,c){var d=this;return e.prototype.update.call(this,a,b,c).then(function(a){if(a){var e,f=[],h=b.poseRef;h&&(e=d._load(h,c).then(function(b){a._skeletonPose=b}),f.push(e));var i=b.layersRef;return i&&(e=d._load(i,c).then(function(b){a.layers=b,a._layersId=i}),f.push(e)),g.all(f).then(function(){return a})}})},a.exports=d},,function(a,b,c){a.exports={AnimationClipHandler:c(84),AnimationComponentHandler:c(87),AnimationLayersHandler:c(90),AnimationStateHandler:c(91),SkeletonHandler:c(92)}},function(a,b,c){function d(){e.apply(this,arguments)}var e=c(85),f=c(76),g=c(55),h=c(6);d.prototype=Object.create(e.prototype),d.prototype.constructor=d,e._registerClass("animation",d),d.prototype._create=function(a){var b=[];return this._objects.set(a,b),b},d.prototype._setInitialState=function(a,b){if(b){var c=a.getStateById(b);a._currentState!==c&&a.setCurrentStateById(b,!0)}else a.setCurrentState()},d.prototype._update=function(a,b,c){var d=this;return e.prototype._update.call(this,a,b,c).then(function(a){if(a){var e=[],f=0;return h.forEach(b.layers,function(b){e.push(d._parseLayer(b,a[f++],c))},null,"sortValue"),g.all(e).then(function(b){a.length=b.length;for(var c=0;c<b.length;c++)a[c]=b[c];return a})}})},d.prototype._parseLayer=function(a,b,c){var d=this;b?b._name=a.name:b=new f(a.name),b.id=a.id,b._transitions=h.deepClone(a.transitions),b._layerBlender&&(void 0!==a.blendWeight?b._layerBlender._blendWeight=a.blendWeight:b._layerBlender._blendWeight=1);var e=[];return h.forEach(a.states,function(a){e.push(d.loadObject(a.stateRef,c).then(function(a){b.setState(a.id,a)}))},null,"sortValue"),g.all(e).then(function(){return d._setInitialState(b,a.initialStateRef),b})},a.exports=d},function(a,b,c){function d(){e.apply(this,arguments)}var e=c(85),f=c(82),g=c(63),h=c(66),i=c(61),j=c(65),k=c(55),l=c(54),m=c(6);d.prototype=Object.create(e.prototype),d.prototype.constructor=d,e._registerClass("animstate",d),d.prototype._create=function(a){var b=new f;return this._objects.set(a,b),b},d.prototype._update=function(a,b,c){var d=this;return e.prototype._update.call(this,a,b,c).then(function(a){return a?(a._name=b.name,a.id=b.id,a._transitions=m.deepClone(b.transitions),d._parseClipSource(b.clipSource,a._sourceTree,c).then(function(b){return a._sourceTree=b,a})):void 0})},d.prototype._parseClipSource=function(a,b,c){switch(a.type){case"Clip":return this.loadObject(a.clipRef,c).then(function(c){b&&b instanceof g?(b._clip=c,b.setFilter(a.filter,a.channels)):b=new g(c,a.filter,a.channels),void 0!==a.loopCount&&(b._clipInstance._loopCount=+a.loopCount),void 0!==a.timeScale&&(b._clipInstance._timeScale=a.timeScale),b._startTime=a.startTime||0;for(var d=1/0,e=0;e<c._channels.length;e++)for(var f=c._channels[e],h=0;h<f._times.length;h++){var i=f._times[h];d>i&&(d=i)}return b._startTime=Math.max(b._startTime,d),b});case"Managed":return b&&b instanceof h||(b=new h),a.clipRef?this.loadObject(a.clipRef,c).then(function(c){return b.initFromClip(c,a.filter,a.channels),b}):l.resolve(b);case"Lerp":var d=[this._parseClipSource(a.clipSourceA,null,c),this._parseClipSource(a.clipSourceB,null,c)];return k.all(d).then(function(c){return b=new i(c[0],c[1]),a.blendWeight&&(b.blendWeight=a.blendWeight),b});case"Frozen":return this._parseClipSource(a.clipSource).then(function(c){return b&&b instanceof j?(b._source=c,b._time=a.frozenTime||0):b=new j(c,a.frozenTime||0),b});default:return console.error("Unable to parse clip source"),l.resolve()}},a.exports=d},function(a,b,c){function d(){e.apply(this,arguments)}var e=c(85),f=c(93),g=c(94),h=c(95),i=c(54),j=c(6);d.prototype=Object.create(e.prototype),d.prototype.constructor=d,e._registerClass("skeleton",d),d.prototype._update=function(a,b){if(!this._objects.has(a)){
if(!b)return i.resolve();var c=[];j.forEach(b.joints,function(a){var b=new f(a.name);b._index=a.index,b._parentIndex=a.parentIndex,b._inverseBindPose.matrix.data.set(a.inverseBindPose),c.push(b)},null,"index");var d=new g(b.name,c),e=new h(d);e.setToBindPose(),this._objects.set(a,e)}return i.resolve(this._objects.get(a))},a.exports=d},function(a,b,c){function d(a){this._name=a,this._index=0,this._parentIndex=d.NO_PARENT,this._inverseBindPose=new e}var e=c(41);d.NO_PARENT=-32768,a.exports=d},function(a,b,c){function d(a,b){this._name=a,this._joints=b}var e=c(93);d.prototype.clone=function(){for(var a=this._name,b=this._joints,c=[],f=0,g=b.length;g>f;f++){var h=b[f],i=h._name,j=new e(i);j._index=h._index,j._parentIndex=h._parentIndex,j._inverseBindPose.copy(h._inverseBindPose),j._inverseBindPose.update(),c[f]=j}return new d(a,c)},a.exports=d},function(a,b,c){function d(a){this._skeleton=a,this._localTransforms=[],this._globalTransforms=[],this._matrixPalette=[],this._poseListeners=[];for(var b=this._skeleton._joints.length,c=0;b>c;c++)this._localTransforms[c]=new e;for(var c=0;b>c;c++)this._globalTransforms[c]=new e;for(var c=0;b>c;c++)this._matrixPalette[c]=new g;this.setToBindPose()}var e=c(41),f=c(93),g=c(33);d.prototype.setToBindPose=function(){for(var a=0;a<this._localTransforms.length;a++){this._localTransforms[a].matrix.copy(this._skeleton._joints[a]._inverseBindPose.matrix).invert();var b=this._skeleton._joints[a]._parentIndex;b!==f.NO_PARENT&&this._localTransforms[a].matrix.mul2(this._skeleton._joints[b]._inverseBindPose.matrix,this._localTransforms[a].matrix)}this.updateTransforms()},d.prototype.updateTransforms=function(){for(var a=this._skeleton._joints,b=0,c=a.length;c>b;b++){var d=a[b]._parentIndex;d!==f.NO_PARENT?this._globalTransforms[b].matrix.mul2(this._globalTransforms[d].matrix,this._localTransforms[b].matrix):this._globalTransforms[b].matrix.copy(this._localTransforms[b].matrix),this._matrixPalette[b].mul2(this._globalTransforms[b].matrix,a[b]._inverseBindPose.matrix)}this.firePoseUpdated()},d.prototype.firePoseUpdated=function(){for(var a=this._poseListeners.length-1;a>=0;a--)this._poseListeners[a].poseUpdated(this)},d.prototype.clone=function(){return new d(this._skeleton)},a.exports=d},function(a,b,c){function d(){e.call(this,"AnimationSystem",["AnimationComponent"])}var e=c(42),f=c(34);d.prototype=Object.create(e.prototype),d.prototype.process=function(){for(var a=0;a<this._activeEntities.length;a++){var b=this._activeEntities[a],c=b.animationComponent;c.update(f.time),c.apply(b.transformComponent),c.postUpdate()}},d.prototype.pause=function(){this.passive=!0;for(var a=0;a<this._activeEntities.length;a++)this._activeEntities[a].animationComponent.pause()},d.prototype.resume=function(){this.passive=!1;for(var a=0;a<this._activeEntities.length;a++){var b=this._activeEntities[a];b.animationComponent.resume()}},d.prototype.play=d.prototype.resume,d.prototype.stop=function(){this.passive=!0;for(var a=0;a<this._activeEntities.length;a++){var b=this._activeEntities[a];b.animationComponent.stop()}},a.exports=d}]);